# MCP Marketplace Registry
#
# This is the official OctopusOS MCP Package registry. Each package represents
# an MCP server that can be "attached" to OctopusOS (not "installed").
#
# Attachment Process:
# 1. Discover: Browse packages in this registry
# 2. Inspect: Review tools, side effects, and risks
# 3. Approve: Review governance preview (Trust Tier, Quota, Gates)
# 4. Attach: Add to local MCP config (disabled by default)
# 5. Enable: Use CLI or API to enable the server
#
# This is NOT a plugin store - it's a capability discovery layer.

version: "1.0"
packages:
  # ============================================
  # T0: Official OctopusOS MCPs
  # ============================================
  - package_id: "octopusos.official/echo-math"
    name: "Echo Math Calculator"
    version: "1.0.0"
    author: "OctopusOS Team"
    description: "Simple echo and math tools for testing and demonstrations"
    long_description: |
      A minimal MCP server providing echo and basic arithmetic operations.
      Perfect for testing MCP integration without side effects.
    
    tools:
      - name: "echo"
        description: "Echo back the input message"
        input_schema:
          type: "object"
          properties:
            message:
              type: "string"
              description: "Message to echo"
          required: ["message"]
        side_effects: []
        requires_confirmation: false
      
      - name: "add"
        description: "Add two numbers"
        input_schema:
          type: "object"
          properties:
            a:
              type: "number"
              description: "First number"
            b:
              type: "number"
              description: "Second number"
          required: ["a", "b"]
        side_effects: []
        requires_confirmation: false
    
    declared_side_effects: []
    
    transport: "stdio"
    connection_template:
      command: "npx"
      args: ["-y", "@modelcontextprotocol/server-echo"]
      env: {}
    
    recommended_trust_tier: "T0"
    recommended_quota_profile: "loose"
    requires_admin_token: false
    
    homepage: "https://github.com/modelcontextprotocol/servers/tree/main/src/echo"
    repository: "https://github.com/modelcontextprotocol/servers"
    license: "MIT"
    tags: ["official", "testing", "math", "utilities"]

  - package_id: "octopusos.official/email"
    name: "Email"
    version: "0.1.0"
    author: "OctopusOS Team"
    description: "Email tools (unread digest, read message, draft reply, send) via the local OctopusOS backend"
    long_description: |
      Local MCP server that exposes Email tools by forwarding requests to a running
      OctopusOS WebUI backend (HTTP).

      This keeps all existing policy gates, audit logs, and confirmation flows in one place.
      In particular, sending email remains confirmation-based.

    tools:
      - name: "email.list_unread"
        description: "List unread emails and generate a digest"
        input_schema:
          type: "object"
          properties:
            instance_id:
              type: "string"
              description: "Email provider instance id"
            since:
              type: "string"
              description: "today|all"
            limit:
              type: "number"
              description: "Max messages to fetch (1..200)"
            tz:
              type: "string"
              description: "Timezone (e.g. Australia/Sydney)"
          required: ["instance_id"]
        side_effects: ["network_read"]
        requires_confirmation: false

      - name: "email.get_message"
        description: "Fetch a single email message"
        input_schema:
          type: "object"
          properties:
            instance_id:
              type: "string"
            message_id:
              type: "string"
          required: ["instance_id", "message_id"]
        side_effects: ["network_read"]
        requires_confirmation: false

      - name: "email.draft_reply"
        description: "Create a polished reply draft (confirmation required to actually send)"
        input_schema:
          type: "object"
          properties:
            instance_id:
              type: "string"
            message_id:
              type: "string"
            user_text:
              type: "string"
              description: "User intent for the reply"
          required: ["instance_id", "message_id"]
        side_effects: ["network_read"]
        requires_confirmation: false

      - name: "email.send_draft"
        description: "Send a draft reply (must be confirmation-based)"
        input_schema:
          type: "object"
          properties:
            instance_id:
              type: "string"
            draft_id:
              type: "string"
            confirm_token:
              type: "string"
            user_confirmed:
              type: "boolean"
          required: ["instance_id", "draft_id", "confirm_token", "user_confirmed"]
        side_effects: ["network_write"]
        requires_confirmation: true

    declared_side_effects:
      - "network_read"
      - "network_write"

    transport: "stdio"
    connection_template:
      command: "node"
      args: ["servers/email-mcp/index.js"]
      env:
        OCTOPUSOS_BACKEND_ORIGIN: "http://127.0.0.1:8080"

    recommended_trust_tier: "T1"
    recommended_quota_profile: "medium"
    requires_admin_token: false

    homepage: "https://octopusos.local/channels/email"
    repository: "local"
    license: "MIT"
    tags: ["official", "email", "communication", "local"]

  # ============================================
  # T1: Verified Stdio MCPs (Local, No Network)
  # ============================================
  - package_id: "community/filesystem"
    name: "Filesystem Tools"
    version: "1.2.0"
    author: "MCP Community"
    description: "Local filesystem operations (read, write, list)"
    long_description: |
      Provides tools for reading, writing, and listing files on the local filesystem.
      High-risk due to filesystem write capabilities.
    
    tools:
      - name: "read_file"
        description: "Read contents of a file"
        input_schema:
          type: "object"
          properties:
            path:
              type: "string"
              description: "File path to read"
          required: ["path"]
        side_effects: ["filesystem_read"]
        requires_confirmation: false
      
      - name: "write_file"
        description: "Write content to a file"
        input_schema:
          type: "object"
          properties:
            path:
              type: "string"
              description: "File path to write"
            content:
              type: "string"
              description: "Content to write"
          required: ["path", "content"]
        side_effects: ["filesystem_write"]
        requires_confirmation: true
      
      - name: "delete_file"
        description: "Delete a file"
        input_schema:
          type: "object"
          properties:
            path:
              type: "string"
              description: "File path to delete"
          required: ["path"]
        side_effects: ["filesystem_delete"]
        requires_confirmation: true
      
      - name: "list_directory"
        description: "List files in a directory"
        input_schema:
          type: "object"
          properties:
            path:
              type: "string"
              description: "Directory path"
          required: ["path"]
        side_effects: ["filesystem_read"]
        requires_confirmation: false
    
    declared_side_effects: 
      - "filesystem_read"
      - "filesystem_write"
      - "filesystem_delete"
    
    transport: "stdio"
    connection_template:
      command: "npx"
      args: ["-y", "@modelcontextprotocol/server-filesystem"]
      env: {}
    
    recommended_trust_tier: "T1"
    recommended_quota_profile: "medium"
    requires_admin_token: true
    
    homepage: "https://github.com/modelcontextprotocol/servers/tree/main/src/filesystem"
    repository: "https://github.com/modelcontextprotocol/servers"
    license: "MIT"
    tags: ["filesystem", "io", "local", "high-risk"]

  # ============================================
  # T3: Cloud Service MCPs (Network, API Calls)
  # ============================================
  - package_id: "smithery.ai/github"
    name: "GitHub Integration"
    version: "2.1.0"
    author: "Smithery AI"
    description: "GitHub API integration for issues, PRs, repos"
    long_description: |
      Comprehensive GitHub integration allowing read and write operations
      on repositories, issues, pull requests, and more.
      
      Requires GitHub personal access token with appropriate scopes.
      High-risk due to potential for code modifications and PR approvals.
    
    tools:
      - name: "create_issue"
        description: "Create a GitHub issue"
        input_schema:
          type: "object"
          properties:
            repo:
              type: "string"
              description: "Repository (owner/repo)"
            title:
              type: "string"
              description: "Issue title"
            body:
              type: "string"
              description: "Issue body"
          required: ["repo", "title"]
        side_effects: ["network_write", "cloud_resource_create"]
        requires_confirmation: true
      
      - name: "list_pull_requests"
        description: "List pull requests in a repository"
        input_schema:
          type: "object"
          properties:
            repo:
              type: "string"
              description: "Repository (owner/repo)"
            state:
              type: "string"
              enum: ["open", "closed", "all"]
              description: "PR state filter"
          required: ["repo"]
        side_effects: ["network_read"]
        requires_confirmation: false
      
      - name: "merge_pull_request"
        description: "Merge a pull request"
        input_schema:
          type: "object"
          properties:
            repo:
              type: "string"
              description: "Repository (owner/repo)"
            pr_number:
              type: "integer"
              description: "Pull request number"
            merge_method:
              type: "string"
              enum: ["merge", "squash", "rebase"]
              description: "Merge method"
          required: ["repo", "pr_number"]
        side_effects: ["network_write", "cloud_resource_create"]
        requires_confirmation: true
    
    declared_side_effects:
      - "network_read"
      - "network_write"
      - "cloud_resource_create"
    
    transport: "stdio"
    connection_template:
      command: "npx"
      args: ["-y", "@smithery/mcp-server-github"]
      env:
        GITHUB_TOKEN: "${GITHUB_TOKEN}"  # User must provide
    
    recommended_trust_tier: "T3"
    recommended_quota_profile: "medium"
    requires_admin_token: true
    
    homepage: "https://smithery.ai/server/@smithery/mcp-server-github"
    repository: "https://github.com/smithery-ai/mcp-servers"
    license: "MIT"
    tags: ["github", "cloud", "git", "devtools", "critical-risk"]

  - package_id: "smithery.ai/slack"
    name: "Slack Integration"
    version: "1.5.0"
    author: "Smithery AI"
    description: "Slack workspace integration for messaging and channels"
    long_description: |
      Send messages, create channels, and manage Slack workspaces.
      
      Requires Slack Bot Token with appropriate OAuth scopes.
      Medium-risk for notification spam and channel management.
    
    tools:
      - name: "send_message"
        description: "Send a message to a Slack channel"
        input_schema:
          type: "object"
          properties:
            channel:
              type: "string"
              description: "Channel ID or name"
            text:
              type: "string"
              description: "Message text"
          required: ["channel", "text"]
        side_effects: ["network_write", "user_notification"]
        requires_confirmation: true
      
      - name: "list_channels"
        description: "List channels in workspace"
        input_schema:
          type: "object"
          properties:
            types:
              type: "string"
              description: "Channel types (public_channel, private_channel)"
          required: []
        side_effects: ["network_read"]
        requires_confirmation: false
    
    declared_side_effects:
      - "network_read"
      - "network_write"
      - "user_notification"
    
    transport: "stdio"
    connection_template:
      command: "npx"
      args: ["-y", "@smithery/mcp-server-slack"]
      env:
        SLACK_BOT_TOKEN: "${SLACK_BOT_TOKEN}"  # User must provide
    
    recommended_trust_tier: "T3"
    recommended_quota_profile: "tight"
    requires_admin_token: true
    
    homepage: "https://smithery.ai/server/@smithery/mcp-server-slack"
    repository: "https://github.com/smithery-ai/mcp-servers"
    license: "MIT"
    tags: ["slack", "communication", "cloud", "notifications"]

  - package_id: "aws.mcp"
    name: "AWS MCP"
    version: "0.1.0"
    author: "OctopusOS Team"
    description: "Query and operate AWS services via MCP tools"
    long_description: |
      AWS MCP adapter exposing read and operation tools for AWS services.
      Profile and region are injected from attach config into environment variables.

    tools:
      - name: "aws_sts_get_caller_identity"
        description: "Get current AWS account identity"
        input_schema:
          type: "object"
          properties: {}
          required: []
        side_effects: ["network_read"]
        requires_confirmation: false

      - name: "aws_s3_list_buckets"
        description: "List S3 buckets"
        input_schema:
          type: "object"
          properties: {}
          required: []
        side_effects: ["network_read"]
        requires_confirmation: false

      - name: "aws_ec2_describe_instances"
        description: "List EC2 instances and instance specs"
        input_schema:
          type: "object"
          properties: {}
          required: []
        side_effects: ["network_read"]
        requires_confirmation: false

      - name: "aws_ec2_describe_instance_status"
        description: "Check EC2 instance runtime and status check health"
        input_schema:
          type: "object"
          properties: {}
          required: []
        side_effects: ["network_read"]
        requires_confirmation: false

      - name: "aws_cloudwatch_get_metric_data"
        description: "Inspect EC2 load and utilization metrics (CPU/network/disk)"
        input_schema:
          type: "object"
          properties: {}
          required: []
        side_effects: ["network_read"]
        requires_confirmation: false

      - name: "aws_ce_get_cost_and_usage"
        description: "Check monthly AWS cost and usage"
        input_schema:
          type: "object"
          properties: {}
          required: []
        side_effects: ["network_read"]
        requires_confirmation: false

      - name: "aws_ce_get_cost_breakdown"
        description: "Explain monthly cost composition by service and usage type"
        input_schema:
          type: "object"
          properties: {}
          required: []
        side_effects: ["network_read"]
        requires_confirmation: false

      - name: "aws_servicequotas_list_services"
        description: "Check enabled service domains and quota availability"
        input_schema:
          type: "object"
          properties: {}
          required: []
        side_effects: ["network_read"]
        requires_confirmation: false

    declared_side_effects:
      - "network_read"
      - "network_write"
      - "system_command"

    transport: "stdio"
    connection_template:
      command: "uvx"
      args: ["awslabs.aws-api-mcp-server@latest"]
      env:
        AWS_PROFILE: "{{profile}}"
        AWS_REGION: "{{region}}"

    recommended_trust_tier: "T2"
    recommended_quota_profile: "medium"
    requires_admin_token: true

    homepage: "https://aws.amazon.com"
    repository: "https://github.com/aws"
    license: "Apache-2.0"
    tags: ["aws", "cloud", "devops", "infrastructure"]
