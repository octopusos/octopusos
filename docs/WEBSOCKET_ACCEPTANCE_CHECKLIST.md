# WebSocket å®ˆé—¨å‘˜éªŒæ”¶æ¸…å•

> ğŸ¯ **ç›®æ ‡**: ç¡®ä¿ WebSocket ä¿®æ”¹ä¸ä¼šå¼•å…¥æ–°å‘ï¼ˆé‡å¤è¿æ¥/æ¶ˆæ¯é‡å¤/èµ„æºæ³„æ¼/è¯¯åˆ¤æ–­çº¿ï¼‰

**ä¿®æ”¹ç‰ˆæœ¬**: v0.3.2+ws-fixes
**æµ‹è¯•æ—¶é—´**: 10 åˆ†é’Ÿ
**æµ‹è¯•å¹³å°**: Mac Safari, Windows Chrome/Edge

---

## ğŸ“‹ P0 å®ˆé—¨å‘˜éªŒæ”¶ï¼ˆå¿…é¡»é€šè¿‡ï¼‰

### 1ï¸âƒ£ è¿æ¥å”¯ä¸€æ€§ï¼ˆé¿å…é‡å¤è¿æ¥ / é‡å¤ onmessageï¼‰

**ç›®æ ‡**: æ— è®ºæ€ä¹ˆåˆ‡é¡µé¢/åé€€/åˆ‡ sessionï¼Œéƒ½åªå­˜åœ¨ 1 æ¡æœ‰æ•ˆ WSã€‚

**æ“ä½œæ­¥éª¤**:
```javascript
// 1. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°
wsDebug()  // æŸ¥çœ‹å½“å‰çŠ¶æ€

// 2. æ‰“å¼€ DevTools â†’ Network â†’ WS
// è§‚å¯Ÿæ˜¯å¦æœ‰å¤šæ¡è¿æ¥åŒæ—¶å­˜åœ¨

// 3. è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•
wsTest.test1_ConnectionUniqueness()
```

**âœ… é€šè¿‡æ ‡å‡†**:
- åŒä¸€æ—¶åˆ»æœ€å¤š 1 æ¡ WS è¿æ¥å¤„äº OPEN
- æ”¶åˆ°ä¸€æ¡æœåŠ¡ç«¯æ¶ˆæ¯ï¼ŒUI åªè¿½åŠ ä¸€æ¬¡ï¼ˆä¸é‡å¤ï¼‰
- Network é¢æ¿åªæ˜¾ç¤º 1 æ¡æ´»è·ƒè¿æ¥

**âŒ è¸©é›·ç—‡çŠ¶**:
- æ¶ˆæ¯é‡å¤å‡ºç°ï¼ˆå…¸å‹ï¼šé‡å¤ç»‘å®šç›‘å¬ or å¤šè¿æ¥å¹¶å­˜ï¼‰
- WS é¢æ¿é‡Œçœ‹åˆ°ä¸¤æ¡ `/ws/chat/{session}` éƒ½ OPEN
- æ§åˆ¶å°çœ‹åˆ°å¤šä¸ª `[WS] connected` æ—¥å¿—

**ğŸ”§ æœ€å°ä¿®è¡¥ç‚¹**ï¼ˆå¦‚æœå‡ºç°ï¼‰:
```javascript
// åœ¨ pageshow/visibility/focus è§¦å‘æ—¶å…ˆ close å† connect
// æˆ–è€… connect() å†…æ›´ä¸¥æ ¼çš„"åŒ URL + OPEN/CONNECTING ç›´æ¥ return"
```

---

### 2ï¸âƒ£ Safari bfcache å¤æ´»ï¼ˆæœ€å…³é”®åœºæ™¯ï¼‰

**ç›®æ ‡**: åé€€å›æ¥åä¸åˆ·æ–°ä¹Ÿèƒ½ç»§ç»­æ”¶æ¶ˆæ¯ã€‚

**æ“ä½œæ­¥éª¤**:
1. Mac Safari æ‰“å¼€èŠå¤©é¡µé¢
2. å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œç¡®è®¤æ­£å¸¸å·¥ä½œ
3. ç‚¹å‡»å¯¼èˆªåˆ° "Overview" é¡µé¢
4. ç‚¹å‡»æµè§ˆå™¨åé€€æŒ‰é’®è¿”å› "Chat"
5. **ä¸åˆ·æ–°é¡µé¢**ï¼Œç›´æ¥å‘é€æµ‹è¯•æ¶ˆæ¯
6. åœ¨æ§åˆ¶å°æ‰§è¡Œ `wsDebug()` æŸ¥çœ‹çŠ¶æ€

**âœ… é€šè¿‡æ ‡å‡†**:
- æ§åˆ¶å°çœ‹åˆ° `[Lifecycle] pageshow (bfcache restored) â†’ force reconnect`
- çŠ¶æ€æŒ‡ç¤ºå™¨ç»å†ä¸€æ¬¡ `Reconnectingâ€¦` â†’ `Connected`
- ä¸åˆ·æ–°ä¹Ÿèƒ½ç»§ç»­æ”¶æ¶ˆæ¯
- `wsDebug()` æ˜¾ç¤º `URL`ã€`lastOpenAt` å·²æ›´æ–°

**âŒ è¸©é›·ç—‡çŠ¶**:
- åé€€åå‘é€æ¶ˆæ¯æ²¡ååº”
- çŠ¶æ€æŒ‡ç¤ºå™¨æ˜¾ç¤º "Connected" ä½†å®é™…æ”¶ä¸åˆ°æ¶ˆæ¯
- `wsDebug()` æ˜¾ç¤º `readyState: OPEN` ä½† `lastMessageAt` å¾ˆä¹…æ²¡æ›´æ–°

**ğŸ”§ æœ€å°ä¿®è¡¥ç‚¹**ï¼ˆå¦‚æœå‡ºç°ï¼‰:
```javascript
// æ£€æŸ¥ pageshow äº‹ä»¶æ˜¯å¦æ­£ç¡®ç»‘å®š
// ç¡®è®¤ e.persisted åˆ¤æ–­é€»è¾‘
// éªŒè¯ forceReconnect æ˜¯å¦çœŸçš„æ‰§è¡Œäº†
```

---

### 3ï¸âƒ£ å¿ƒè·³çœŸçš„åœ¨èµ·ä½œç”¨ï¼ˆä¸æ˜¯"è‡ªå—¨æ—¥å¿—"ï¼‰

**ç›®æ ‡**: ping/pong çœŸçš„åœ¨å·¥ä½œï¼Œä¸ä¼šè¯¯åˆ¤ä¸ºåƒµå°¸è¿æ¥ã€‚

**æ“ä½œæ­¥éª¤**:
```javascript
// 1. è¿æ¥åç­‰ 1 åˆ†é’Ÿï¼Œè§‚å¯Ÿæ—¥å¿—
// åº”è¯¥çœ‹åˆ°æˆå¯¹çš„ ping/pong

// 2. è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆéœ€è¦ç­‰å¾… 35 ç§’ï¼‰
await wsTest.test3_HeartbeatVerification()

// 3. æ£€æŸ¥ lastMessageAt æ˜¯å¦è¢« pong æ›´æ–°
wsDebug()  // æŸ¥çœ‹ Idle Time
```

**âœ… é€šè¿‡æ ‡å‡†**:
- èƒ½ç¨³å®šçœ‹åˆ° `[WS] sent ping` å’Œ `[WS] received pong` æˆå¯¹å‡ºç°ï¼ˆæ¯ 30 ç§’ï¼‰
- `wsDebug()` æ˜¾ç¤º `lastMessageAt` è¢« pong æ›´æ–°
- é•¿æ—¶é—´ç©ºé—²ï¼ˆ10+ åˆ†é’Ÿï¼‰ä¸ä¼šå‡ºç°èŠ‚å¾‹æ€§é‡è¿

**âŒ è¸©é›·ç—‡çŠ¶**:
- æ¯åˆ° 60 ç§’å°±é‡è¿ä¸€æ¬¡ï¼ˆpong æ²¡æ”¶åˆ° / æ²¡è¢«è¯†åˆ«ï¼‰
- åªçœ‹åˆ° `sent ping` ä½†æ²¡æœ‰ `received pong`
- `lastMessageAt` åªåœ¨ä¸šåŠ¡æ¶ˆæ¯æ—¶æ›´æ–°ï¼Œpong æ—¶ä¸æ›´æ–°

**ğŸ”§ æœ€å°ä¿®è¡¥ç‚¹**ï¼ˆå¦‚æœå‡ºç°ï¼‰:
```javascript
// æ£€æŸ¥åç«¯ pong æ ¼å¼æ˜¯å¦åŒ¹é…
// å½“å‰è¿‡æ»¤: 'pong' æˆ– '{"type":"pong"}'
// å¦‚æœåç«¯è¿”å› {"event":"pong"} éœ€è¦è°ƒæ•´åˆ¤æ–­

// ç¡®è®¤ onmessage ç¬¬ä¸€è¡Œæ›´æ–° lastMessageAt
this.socket.onmessage = (evt) => {
    this.lastMessageAt = Date.now();  // å¿…é¡»åœ¨è¿™é‡Œï¼
    // ...
};
```

---

### 4ï¸âƒ£ Windows "æ–­ç½‘ â†’ æ¢å¤"é‡è¿

**ç›®æ ‡**: æ¢å¤åèƒ½è‡ªåŠ¨å›åˆ° OPENï¼Œä¸éœ€è¦æ‰‹åŠ¨åˆ·æ–°ã€‚

**æ“ä½œæ­¥éª¤**:
1. Windows Chrome/Edge æ‰“å¼€èŠå¤©é¡µé¢
2. å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œç¡®è®¤æ­£å¸¸å·¥ä½œ
3. æ‰§è¡Œ `wsDebug()` è®°å½•å½“å‰çŠ¶æ€
4. æ–­å¼€ç½‘ç»œï¼ˆå…³é—­ WiFi æˆ–æ‹”ç½‘çº¿ï¼‰
5. è§‚å¯Ÿæ§åˆ¶å°ï¼šåº”è¯¥çœ‹åˆ°é‡è¿æ—¥å¿—
6. æ¢å¤ç½‘ç»œ
7. ç­‰å¾…æœ€å¤š 30 ç§’
8. æ‰§è¡Œ `wsDebug()` æ£€æŸ¥æ˜¯å¦æ¢å¤
9. å‘é€æµ‹è¯•æ¶ˆæ¯éªŒè¯

**âœ… é€šè¿‡æ ‡å‡†**:
- æ–­ç½‘æ—¶è¿›å…¥é‡è¿è®¡åˆ’ï¼ˆ`retryCount` é€’å¢ï¼‰
- æ¢å¤ç½‘ç»œååœ¨ 30 ç§’å†…å›åˆ° OPEN
- æ¶ˆæ¯èƒ½ç«‹å³å‘é€æˆåŠŸ

**âŒ è¸©é›·ç—‡çŠ¶**:
- ä¸€ç›´å¡åœ¨ CONNECTING
- `retryCount` æ‰“æ»¡ 10 æ¬¡ä¹Ÿæ²¡æ¢å¤ï¼ˆä½†ç½‘ç»œå·²æ¢å¤ï¼‰
- çŠ¶æ€æŒ‡ç¤ºå™¨æ˜¾ç¤º "Disconnected (Retry limit)"

**ğŸ”§ æœ€å°ä¿®è¡¥ç‚¹**ï¼ˆå¦‚æœå‡ºç°ï¼‰:
```javascript
// æ·»åŠ  CONNECTING è¶…æ—¶æ£€æµ‹
// å¦‚æœè¿æ¥è¶…è¿‡ 10 ç§’è¿˜æ²¡ openï¼Œä¸»åŠ¨ forceReconnect('connect_timeout')
```

---

## ğŸŸ¡ P1 é£é™©ç‚¹ï¼ˆå®¹æ˜“ç¿»è½¦ï¼‰

### A) localhost fallback å¯¼è‡´ cookie/session å·®å¼‚

**é£é™©**: å¦‚æœåç«¯é  cookie æˆ–åŒæºç­–ç•¥ï¼Œ`localhost` å’Œ `127.0.0.1` åœ¨æµè§ˆå™¨è§†è§’æ˜¯ä¸åŒç«™ç‚¹ã€‚

**å½“å‰ç­–ç•¥**: åªåœ¨ `ws://` dev ç¯å¢ƒå¯ç”¨ï¼Œé£é™©å¯æ§ã€‚

**éªŒè¯æ–¹æ³•**:
```javascript
// 1. æ£€æŸ¥ buildUrl é€»è¾‘
console.log(WS.buildUrl(state.currentSession));

// 2. å¦‚æœåç«¯ä¾èµ– cookie é‰´æƒ
// ç¡®è®¤ WebSocket è¯·æ±‚å¤´æ˜¯å¦æºå¸¦ cookie
// DevTools â†’ Network â†’ WS â†’ Headers â†’ Request Headers
```

**ğŸ”§ è°ƒæ•´å»ºè®®**ï¼ˆå¦‚æœè¸©é›·ï¼‰:
- é™åˆ¶ fallback ä»…åœ¨ `window.__AGENTOS_WS_BASE__` é…ç½®æ—¶å¯ç”¨
- æˆ–è€…ç¦ç”¨è‡ªåŠ¨ fallbackï¼Œç”±ç”¨æˆ·æ˜¾å¼é…ç½®

---

### B) lifecycle è§¦å‘è¿‡äºé¢‘ç¹å¯¼è‡´"æŠ–åŠ¨é‡è¿"

**é£é™©**: `visibilitychange` + `focus` åœ¨æŸäº›å¹³å°é¢‘ç¹è§¦å‘ï¼ˆåˆ‡ tabã€å¼¹çª—ã€å¿«æ·é”®ï¼‰ã€‚

**å½“å‰ç­–ç•¥**: 2 ç§’å†·å´æœºåˆ¶ã€‚

**éªŒè¯æ–¹æ³•**:
```javascript
// è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•
await wsTest.test6_LifecycleCooldown()

// æ‰‹åŠ¨éªŒè¯ï¼šå¿«é€Ÿåˆ‡æ¢çª—å£ 5 æ¬¡
// åº”è¯¥åªè§¦å‘ 1 æ¬¡é‡è¿
```

**âœ… é€šè¿‡æ ‡å‡†**:
- é¢‘ç¹åˆ‡æ¢çª—å£ä¸ä¼šå¯¼è‡´ä¸æ–­ forceReconnect
- æ§åˆ¶å°çœ‹åˆ° `lifecycle reconnect skipped (cooldown: Xs)`

**ğŸ”§ è°ƒæ•´å»ºè®®**ï¼ˆè‹¥æŠ–åŠ¨ï¼‰:
- å¢åŠ å†·å´æ—¶é—´åˆ° 5 ç§’
- æˆ–è€…åªä¿ç•™ `pageshow` å¤„ç†ï¼Œç§»é™¤ `focus` ç›‘å¬

---

### C) æ¶ˆæ¯é€‚é…å™¨åæ‰é JSON æ–‡æœ¬

**é£é™©**: åç«¯å¶å°”å‘é€çº¯æ–‡æœ¬æ—¥å¿—æˆ–å¤šç±»å‹äº‹ä»¶ã€‚

**å½“å‰ç­–ç•¥**: JSON.parse å¤±è´¥æ—¶ fallback ä¸º `type: 'event'` æ¶ˆæ¯ã€‚

**éªŒè¯æ–¹æ³•**:
```javascript
// æ¨¡æ‹Ÿå‘é€é JSON æ¶ˆæ¯ï¼ˆéœ€è¦åç«¯é…åˆï¼‰
// æˆ–è€…åœ¨æ§åˆ¶å°æ‰‹åŠ¨è§¦å‘
WS.socket.dispatchEvent(new MessageEvent('message', {
    data: 'plain text log'
}));

// åº”è¯¥åœ¨æ¶ˆæ¯åŒºåŸŸçœ‹åˆ°ä¸€æ¡ event ç±»å‹æ¶ˆæ¯ï¼Œè€Œä¸æ˜¯è¢«åæ‰
```

**âœ… é€šè¿‡æ ‡å‡†**:
- é JSON æ¶ˆæ¯ä¸ä¼šè¢«é™é»˜ä¸¢å¼ƒ
- æ§åˆ¶å°çœ‹åˆ° `[WS] Treating non-JSON message as text event`

---

## ğŸš€ åˆå¹¶å‰å»ºè®®åŠ çš„"ç¡¬æ ¡éªŒ"

### 1. æ–‡æ¡£åŒ– `wsDebug()` å·¥å…·

åœ¨ WebUI çš„ Support/Diagnostics é¡µé¢æ·»åŠ è¯´æ˜ï¼š

```markdown
## WebSocket è°ƒè¯•å·¥å…·

åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œï¼š

- `wsDebug()` - æŸ¥çœ‹ WebSocket è¿æ¥çŠ¶æ€
- `wsReconnect()` - æ‰‹åŠ¨è§¦å‘é‡è¿
- `wsTest.runAll()` - è¿è¡Œå®Œæ•´éªŒæ”¶æµ‹è¯•
```

### 2. æ·»åŠ  UI ä¸Šçš„"æ‰‹åŠ¨é‡è¿"æŒ‰é’®

**ä½ç½®å»ºè®®**: èŠå¤©å·¥å…·æ  WebSocket çŠ¶æ€æŒ‡ç¤ºå™¨æ—è¾¹

**å®ç°**:
```javascript
// ç‚¹å‡»çŠ¶æ€æŒ‡ç¤ºå™¨æ˜¾ç¤ºè¯Šæ–­ä¿¡æ¯ + é‡è¿æŒ‰é’®
document.getElementById('chat-ws-status').addEventListener('click', () => {
    const diag = WS.getDiagnostics();
    const message = `
è¿æ¥çŠ¶æ€: ${diag.readyStateText}
ç©ºé—²æ—¶é—´: ${diag.idleMs ? Math.round(diag.idleMs/1000) + 's' : 'N/A'}
å¥åº·çŠ¶æ€: ${diag.isAlive ? 'âœ…' : 'âŒ'}

æ˜¯å¦æ‰‹åŠ¨é‡è¿ï¼Ÿ
    `;
    if (confirm(message)) {
        WS.forceReconnect('manual_ui_button');
    }
});
```

---

## ğŸ§ª å¿«é€ŸéªŒæ”¶è„šæœ¬

### åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œ

```javascript
// 1. åŠ è½½éªŒæ”¶æµ‹è¯•è„šæœ¬
// æ–¹æ³• A: å¦‚æœå·²åŒ…å«åœ¨é¡µé¢ä¸­
wsTest.runAll()

// æ–¹æ³• B: åŠ¨æ€åŠ è½½
fetch('/static/js/ws-acceptance-test.js')
    .then(r => r.text())
    .then(code => eval(code))
    .then(() => wsTest.runAll());

// 2. æŸ¥çœ‹å½“å‰çŠ¶æ€
wsDebug()

// 3. ç”ŸæˆæŠ¥å‘Šï¼ˆç”¨äº GitHub Issueï¼‰
wsTest.generateReport()
```

---

## ğŸ“Š é—®é¢˜æ’æŸ¥æŒ‡å—

### ç—‡çŠ¶ 1: æ¶ˆæ¯é‡å¤å‡ºç°

**è¯Šæ–­**:
```javascript
wsDebug()  // æŸ¥çœ‹ readyState
// DevTools â†’ Network â†’ WS æŸ¥çœ‹è¿æ¥æ•°
```

**å¯èƒ½åŸå› **:
- é‡å¤ç»‘å®š onmessage ç›‘å¬å™¨
- å¤šä¸ªè¿æ¥åŒæ—¶å­˜åœ¨
- lifecycle äº‹ä»¶è§¦å‘è¿‡äºé¢‘ç¹

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ `_cleanupSocket` æ˜¯å¦æ­£ç¡®æ¸…ç†æ—§è¿æ¥
- éªŒè¯ `connect()` çš„é‡å¤æ£€æŸ¥é€»è¾‘

---

### ç—‡çŠ¶ 2: æ¯ 60 ç§’é‡è¿ä¸€æ¬¡

**è¯Šæ–­**:
```javascript
// è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—
// åº”è¯¥çœ‹åˆ°æˆå¯¹çš„ ping/pong

wsDebug()  // æŸ¥çœ‹ Idle Time
```

**å¯èƒ½åŸå› **:
- pong æ¶ˆæ¯æ ¼å¼ä¸åŒ¹é…
- `lastMessageAt` æœªè¢« pong æ›´æ–°
- pong è¶…æ—¶æ—¶é—´è®¾ç½®è¿‡çŸ­

**è§£å†³æ–¹æ¡ˆ**:
```javascript
// æ£€æŸ¥åç«¯ pong æ ¼å¼
// è°ƒæ•´ onmessage ä¸­çš„ pong è¯†åˆ«é€»è¾‘
if (evt.data === 'pong' ||
    evt.data === '{"type":"pong"}' ||
    evt.data.includes('pong')) {
    // ...
}
```

---

### ç—‡çŠ¶ 3: Windows æ¢å¤ç½‘ç»œåè¿ä¸ä¸Š

**è¯Šæ–­**:
```javascript
wsDebug()  // æŸ¥çœ‹ retryCount
// æ˜¯å¦å·²ç»æ‰“æ»¡ 10 æ¬¡ï¼Ÿ
```

**å¯èƒ½åŸå› **:
- CONNECTING çŠ¶æ€å¡ä½ï¼Œæ²¡æœ‰è¶…æ—¶æ£€æµ‹
- é‡è¿å»¶è¿Ÿå¤ªé•¿ï¼ˆæœ€å¤§ 15 ç§’ï¼‰
- é˜²ç«å¢™/æ€æ¯’è½¯ä»¶é˜»æ­¢è¿æ¥

**è§£å†³æ–¹æ¡ˆ**:
- æ·»åŠ  CONNECTING è¶…æ—¶æ£€æµ‹
- é™ä½æœ€å¤§é‡è¿å»¶è¿Ÿåˆ° 10 ç§’
- æ£€æŸ¥ Windows é˜²ç«å¢™è§„åˆ™

---

### ç—‡çŠ¶ 4: Safari åé€€åæ”¶ä¸åˆ°æ¶ˆæ¯

**è¯Šæ–­**:
```javascript
// åé€€åç«‹å³æ‰§è¡Œ
wsDebug()  // æŸ¥çœ‹ lastOpenAt æ˜¯å¦æ›´æ–°
```

**å¯èƒ½åŸå› **:
- `pageshow` äº‹ä»¶æœªè§¦å‘
- `e.persisted` åˆ¤æ–­é”™è¯¯
- `forceReconnect` æœªæ‰§è¡Œ

**è§£å†³æ–¹æ¡ˆ**:
```javascript
// æ£€æŸ¥äº‹ä»¶ç»‘å®š
window.getEventListeners(window)  // Chrome only

// ç¡®è®¤ lifecycle handler å®‰è£…
console.log('[Lifecycle] WebSocket lifecycle handlers installed');
```

---

## âœ… å®Œæ•´éªŒæ”¶æ¸…å•ï¼ˆå‹¾é€‰è¡¨ï¼‰

### è‡ªåŠ¨åŒ–æµ‹è¯•
- [ ] `wsTest.test1_ConnectionUniqueness()` é€šè¿‡
- [ ] `wsTest.test2_BfcacheReadiness()` é€šè¿‡
- [ ] `wsTest.test3_HeartbeatVerification()` é€šè¿‡ï¼ˆéœ€ç­‰å¾… 35 ç§’ï¼‰
- [ ] `wsTest.test4_NetworkRecoveryReadiness()` é€šè¿‡
- [ ] `wsTest.test5_MessageDuplication()` é€šè¿‡
- [ ] `wsTest.test6_LifecycleCooldown()` é€šè¿‡

### æ‰‹åŠ¨éªŒæ”¶æµ‹è¯•
- [ ] **Safari**: åé€€æ¢å¤æµ‹è¯•é€šè¿‡
- [ ] **Chrome**: ç½‘ç»œæ–­å¼€æ¢å¤æµ‹è¯•é€šè¿‡
- [ ] **Windows**: é•¿æ—¶é—´ç©ºé—²åä»æ­£å¸¸å·¥ä½œ
- [ ] **æ‰€æœ‰å¹³å°**: æ¶ˆæ¯ä¸é‡å¤å‡ºç°
- [ ] **æ‰€æœ‰å¹³å°**: Network é¢æ¿åªæœ‰ 1 æ¡è¿æ¥

### ä»£ç è´¨é‡æ£€æŸ¥
- [ ] JavaScript è¯­æ³•éªŒè¯é€šè¿‡ (`node -c main.js`)
- [ ] æ²¡æœ‰ console.error æŠ¥é”™
- [ ] æ²¡æœ‰æœªæ•è·çš„å¼‚å¸¸
- [ ] èµ„æºæ³„æ¼æ£€æŸ¥ï¼ˆMemory é¢æ¿ï¼Œé•¿æ—¶é—´è¿è¡Œï¼‰

### æ–‡æ¡£å’Œå·¥å…·
- [ ] `wsDebug()` å·¥å…·å¯ç”¨
- [ ] `wsReconnect()` å¿«æ·æ–¹å¼å¯ç”¨
- [ ] éªŒæ”¶æµ‹è¯•è„šæœ¬å¯åŠ è½½
- [ ] README æ›´æ–°æµè§ˆå™¨å…¼å®¹æ€§è¯´æ˜

---

## ğŸ“¤ æäº¤å‰æœ€åæ£€æŸ¥

å¦‚æœæ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œæ‰§è¡Œï¼š

```javascript
// 1. ç”Ÿæˆå®Œæ•´æŠ¥å‘Š
const report = wsTest.generateReport();

// 2. å¤åˆ¶æŠ¥å‘Šå†…å®¹
// 3. åˆ›å»º GitHub Issue: "WebSocket å®ˆé—¨å‘˜éªŒæ”¶æŠ¥å‘Š"
// 4. é™„ä¸ŠæŠ¥å‘Š + wsDebug() è¾“å‡º

// 5. åœ¨ä¸åŒå¹³å°éªŒè¯
// - Mac Safari
// - Mac Chrome
// - Windows Chrome
// - Windows Edge
```

---

## ğŸ†˜ é‡åˆ°é—®é¢˜ï¼Ÿ

å¦‚æœä»»ä½•ä¸€ä¸ª"ç—‡çŠ¶"å‡ºç°ï¼Œè¯·æä¾›ï¼š

1. `wsDebug()` è¾“å‡º
2. æ§åˆ¶å°æœ€å 20 è¡Œ `[WS]` æ—¥å¿—
3. DevTools â†’ Network â†’ WS é¢æ¿æˆªå›¾
4. æ“ä½œæ­¥éª¤ï¼ˆå¦‚ä½•å¤ç°ï¼‰

å°†ä»¥ä¸Šä¿¡æ¯è´´åˆ° GitHub Issueï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å‘Šè¯‰ä½ æ˜¯å“ªä¸€ä¸ªåˆ†æ”¯é€»è¾‘åœ¨ä½œæ€ªã€æ€ä¹ˆç”¨æœ€å° diff ä¿®æ‰ã€‚

---

**æœ€åæ›´æ–°**: 2026-01-29
**è´Ÿè´£äºº**: WebSocket å®ˆé—¨å‘˜å›¢é˜Ÿ
