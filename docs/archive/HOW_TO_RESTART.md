# å¦‚ä½•å®Œæ•´é‡å¯æœåŠ¡å™¨

## é—®é¢˜

ä»£ç å·²ä¿®æ”¹ï¼Œä½†æœåŠ¡å™¨ï¼ˆPID 57466ï¼‰ä»åœ¨è¿è¡Œæ—§ä»£ç ã€‚

## âš¡ å¿«é€Ÿè§£å†³ï¼ˆæ¨èï¼‰

**è¿è¡Œå®Œæ•´é‡å¯è„šæœ¬**ï¼š

```bash
cd /Users/pangge/PycharmProjects/AgentOS
./restart_server_complete.sh
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
- âœ… æ‰¾åˆ°å¹¶åœæ­¢æ‰€æœ‰ uvicorn è¿›ç¨‹
- âœ… é‡Šæ”¾ç«¯å£ 9090
- âœ… æ¸…ç† PID æ–‡ä»¶
- âœ… éªŒè¯ä»£ç ä¿®æ”¹å·²å°±ä½
- âœ… å¯åŠ¨æ–°æœåŠ¡å™¨
- âœ… éªŒè¯æœåŠ¡å™¨æ­£å¸¸è¿è¡Œ

## ğŸ“‹ æ‰‹åŠ¨æ­¥éª¤ï¼ˆå¦‚æœè„šæœ¬å¤±è´¥ï¼‰

### 1. åœæ­¢æ—§è¿›ç¨‹

```bash
# æŸ¥æ‰¾æ‰€æœ‰ uvicorn è¿›ç¨‹
ps aux | grep "[u]vicorn.*agentos"

# åœæ­¢æ‰€æœ‰è¿›ç¨‹
pkill -f "uvicorn agentos"

# ç­‰å¾… 2 ç§’
sleep 2

# éªŒè¯å·²åœæ­¢
ps aux | grep "[u]vicorn.*agentos"

# å¦‚æœè¿˜åœ¨è¿è¡Œï¼Œå¼ºåˆ¶åœæ­¢
pkill -9 -f "uvicorn agentos"
```

### 2. æ£€æŸ¥ç«¯å£

```bash
# æ£€æŸ¥ç«¯å£ 9090 æ˜¯å¦è¢«å ç”¨
lsof -i :9090

# å¦‚æœè¢«å ç”¨ï¼Œå¼ºåˆ¶é‡Šæ”¾
lsof -ti:9090 | xargs kill -9
```

### 3. æ¸…ç† PID æ–‡ä»¶

```bash
rm -f ~/.agentos/webui.pid
```

### 4. éªŒè¯ä»£ç ä¿®æ”¹

```bash
# æ£€æŸ¥ä¿®å¤æ˜¯å¦å­˜åœ¨
grep -n "create_install_record_without_fk" agentos/webui/api/extensions.py
```

åº”è¯¥çœ‹åˆ°ç±»ä¼¼ï¼š
```
451:        registry.create_install_record_without_fk(
665:        registry.create_install_record_without_fk(
```

### 5. å¯åŠ¨æ–°æœåŠ¡å™¨

```bash
# æ–¹æ³• 1: ä½¿ç”¨ CLIï¼ˆæ¨èï¼‰
uv run agentos webui start

# æ–¹æ³• 2: ç›´æ¥ä½¿ç”¨ uvicornï¼ˆå¼€å‘æ¨¡å¼ï¼‰
uvicorn agentos.webui.app:app --host 127.0.0.1 --port 9090 --reload
```

**æ³¨æ„**ï¼šæ·»åŠ  `--reload` å‚æ•°å¯ä»¥è‡ªåŠ¨é‡è½½ä»£ç ï¼ˆå¼€å‘æ¨¡å¼ï¼‰

### 6. éªŒè¯æœåŠ¡å™¨å·²å¯åŠ¨

```bash
# æ£€æŸ¥è¿›ç¨‹
ps aux | grep "[u]vicorn.*agentos"

# æµ‹è¯• API
curl http://127.0.0.1:9090/api/health

# åº”è¯¥è¿”å› {"status": "ok"}
```

## âœ… éªŒè¯ä¿®å¤æ˜¯å¦ç”Ÿæ•ˆ

### æµ‹è¯• 1: å®Œæ•´çš„å®‰è£…æµç¨‹è°ƒè¯•

```bash
python3 debug_install_step_by_step.py
```

**æœŸæœ›ç»“æœ**ï¼š
- âœ… Install Record ç«‹å³è¢«åˆ›å»º
- âœ… ä¸å†è¿”å› 404
- âœ… èƒ½æŸ¥è¯¢åˆ°å®‰è£…è¿›åº¦
- âœ… å¦‚æœéªŒè¯å¤±è´¥ï¼Œè¿”å› FAILED çŠ¶æ€å’Œé”™è¯¯ä¿¡æ¯

### æµ‹è¯• 2: ä¸“é—¨æµ‹è¯• 404 ä¿®å¤

```bash
python3 test_404_fix.py
```

**æœŸæœ›ç»“æœ**ï¼š
- âœ… é”™è¯¯çš„ ZIP ç»“æ„è¿”å› FAILEDï¼ˆä¸æ˜¯ 404ï¼‰
- âœ… æ­£å¸¸çš„ ZIP èƒ½çœ‹åˆ°å®‰è£…è¿›åº¦
- âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡

## ğŸ”§ å¼€å‘æ¨¡å¼ï¼ˆæ¨èï¼‰

ä¸ºäº†é¿å…æ¯æ¬¡ä¿®æ”¹ä»£ç éƒ½è¦é‡å¯ï¼Œå¯ä»¥ä½¿ç”¨ `--reload` æ¨¡å¼ï¼š

```bash
# åœæ­¢å½“å‰æœåŠ¡å™¨
pkill -f "uvicorn agentos"

# å¯åŠ¨å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡è½½ï¼‰
uvicorn agentos.webui.app:app --host 127.0.0.1 --port 9090 --reload &
```

è¿™æ ·ä¿®æ”¹ä»£ç åä¼šè‡ªåŠ¨é‡å¯æœåŠ¡å™¨ã€‚

## â“ å¸¸è§é—®é¢˜

### Q: è„šæœ¬æŠ¥é”™ "ç«¯å£ä»è¢«å ç”¨"

```bash
# å¼ºåˆ¶é‡Šæ”¾ç«¯å£
lsof -ti:9090 | xargs kill -9

# å†æ¬¡è¿è¡Œè„šæœ¬
./restart_server_complete.sh
```

### Q: restart å‘½ä»¤ä¸å·¥ä½œ

```bash
# æ‰‹åŠ¨åœæ­¢
pkill -f "uvicorn agentos"

# æ‰‹åŠ¨å¯åŠ¨
uv run agentos webui start
```

### Q: ä»£ç ä¿®æ”¹åè¿˜æ˜¯ä¸ç”Ÿæ•ˆ

1. ç¡®è®¤æ–‡ä»¶å·²ä¿å­˜
2. ç¡®è®¤è¿›ç¨‹å·²å®Œå…¨åœæ­¢ï¼š`ps aux | grep uvicorn`
3. ç¡®è®¤æ²¡æœ‰å¤šä¸ª Python ç¯å¢ƒ
4. ä½¿ç”¨ `--reload` å‚æ•°å¯åŠ¨

### Q: æµ‹è¯•è„šæœ¬ä»ç„¶çœ‹åˆ° 404

å¯èƒ½åŸå› ï¼š
1. æœåŠ¡å™¨æœªé‡å¯ â†’ è¿è¡Œ `./restart_server_complete.sh`
2. é”™è¯¯çš„è¿›ç¨‹ä»åœ¨è¿è¡Œ â†’ è¿è¡Œ `pkill -9 -f "uvicorn agentos"`
3. ä»£ç æœªä¿å­˜ â†’ æ£€æŸ¥æ–‡ä»¶ä¿®æ”¹æ—¶é—´

## ğŸ“Š å®Œæ•´æµç¨‹ç¤ºæ„å›¾

```
[ä¿®æ”¹ä»£ç ] â†’ [åœæ­¢æ—§è¿›ç¨‹] â†’ [éªŒè¯ç«¯å£é‡Šæ”¾] â†’ [å¯åŠ¨æ–°è¿›ç¨‹] â†’ [æµ‹è¯•éªŒè¯]
    â†“              â†“                 â†“                 â†“              â†“
  extensions.py  pkill uvicorn   lsof :9090      uv run start   test_404_fix.py
  registry.py                                                    debug_install.py
```

## ğŸ¯ ä¸‹ä¸€æ­¥

é‡å¯æˆåŠŸåï¼š

1. **æµ‹è¯• 404 ä¿®å¤**ï¼š
   ```bash
   python3 test_404_fix.py
   ```

2. **åœ¨ WebUI ä¸­æµ‹è¯•**ï¼š
   - æ‰“å¼€ http://127.0.0.1:9090
   - è¿›å…¥ Extensions é¡µé¢
   - ä¸Šä¼  `postman-extension.zip`
   - è§‚å¯Ÿå®‰è£…è¿›åº¦
   - å¦‚æœå¤±è´¥ï¼Œåº”è¯¥çœ‹åˆ°æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯ï¼ˆä¸æ˜¯ 404ï¼‰

3. **éªŒè¯å®Œæ•´åŠŸèƒ½**ï¼š
   ```bash
   python3 debug_install_step_by_step.py
   ```

## ğŸ“ æ£€æŸ¥æ¸…å•

åœ¨æŠ¥å‘Šé—®é¢˜ä¹‹å‰ï¼Œè¯·ç¡®è®¤ï¼š

- [ ] æ—§è¿›ç¨‹å·²å®Œå…¨åœæ­¢ï¼ˆ`ps aux | grep uvicorn` æ— è¾“å‡ºï¼‰
- [ ] ç«¯å£ 9090 å·²é‡Šæ”¾ï¼ˆ`lsof -i :9090` æ— è¾“å‡ºï¼‰
- [ ] æ–°è¿›ç¨‹å·²å¯åŠ¨ï¼ˆ`ps aux | grep uvicorn` æœ‰è¾“å‡ºï¼‰
- [ ] API å¯è®¿é—®ï¼ˆ`curl http://127.0.0.1:9090/api/health` è¿”å› OKï¼‰
- [ ] ä»£ç ä¿®æ”¹å·²å°±ä½ï¼ˆ`grep create_install_record_without_fk agentos/webui/api/extensions.py` æœ‰ç»“æœï¼‰
- [ ] æµ‹è¯•è„šæœ¬å·²è¿è¡Œï¼ˆ`python3 test_404_fix.py`ï¼‰

å…¨éƒ¨ âœ… åï¼Œä¿®å¤åº”è¯¥å·²ç”Ÿæ•ˆï¼
