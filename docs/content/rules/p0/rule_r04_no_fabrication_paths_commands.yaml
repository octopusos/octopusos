id: rule_r04_no_fabrication_paths_commands
type: rule
title: "Paths and commands must come from evidence"
description: "File paths and commands used in planning must be sourced from factpack/scan evidence. Fabrication or hallucination is forbidden."
version: "0.9.0"
status: active

lineage:
  introduced_in: "v0.9"
  derived_from: null
  supersedes: []

constraints:
  execution: forbidden

rule:
  severity: error
  scope:
    applies_to_types: ["workflow", "command"]
    applies_to_risk: ["medium", "high", "critical"]
    applies_to_phases: ["analysis", "design", "implementation"]

  when:
    any_of:
      - path_not_in_factpack: true
      - command_not_in_scan: true
      - fabricated_reference: true

  then:
    decision: deny
    reason: "All paths and commands must be validated against factpack evidence"
    required_changes:
      - "Cross-reference paths with factpack.files"
      - "Validate commands against project_scan results"
      - "Remove fabricated or hallucinated references"

  evidence_required:
    - "factpack"
    - "project_scan"
    - "path_validation"

metadata:
  tags: ["evidence", "factpack", "integrity"]
  author: "AgentOS Team"
