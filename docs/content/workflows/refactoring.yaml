id: refactoring
version: 0.6.0
category: implementation
description: >
  Improve internal structure without changing behavior.
  
  This workflow guides code quality improvements through intentional refactoring
  with regression protection. It maintains external behavior while improving
  internal structure.

phases:
  - id: refactor_intent
    description: Define refactoring intent and scope
    requires: [current_code, quality_issues]
    produces: [refactor_plan]
    allows_questions: true
    risk_level: medium

  - id: refactor_execution
    description: Execute the refactoring
    requires: [refactor_plan]
    produces: [refactored_code]
    allows_questions: false
    risk_level: high

  - id: regression_check
    description: Verify no behavior changes
    requires: [refactored_code, test_suite]
    produces: [regression_report]
    allows_questions: false
    risk_level: high

interaction:
  default_mode: question_only
  question_policy:
    trigger_when:
      - scope_unclear
      - risk_assessment_needed
  allowed_phases: [refactor_intent]

constraints:
  execution: forbidden
  side_effects: forbidden
  requires_approval: false

lineage:
  introduced_in: v0.6
  derived_from: null
  change_reason: null

metadata:
  tags: [refactoring, code-quality, maintenance]
  related_workflows: [feature_implementation, maintenance_planning]
  use_cases:
    - Code quality degradation
    - Technical debt reduction
    - Preparing for new features
  anti_use_cases:
    - Adding new functionality (use feature_implementation)
    - Fixing bugs that change behavior
    - Architectural overhaul (use architectural_evolution)
