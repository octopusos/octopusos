# AgentOS åŠŸèƒ½å®ç°æ¸…å•

> **ç‰ˆæœ¬**: 0.3.1 (Architecture Stable Release)
> **ç”Ÿæˆæ—¥æœŸ**: 2026-01-27
> **æ›´æ–°æ—¥æœŸ**: 2026-01-27
> **ä»£ç è§„æ¨¡**: ~37,000 è¡Œæ ¸å¿ƒä»£ç  | 46 ä¸ªé¡¶å±‚åŒ… | 250+ Python æ–‡ä»¶

æœ¬æ–‡æ¡£è¯¦ç»†åˆ—å‡º AgentOS é¡¹ç›®ä¸­å·²å®ç°å’Œå¾…å®ç°çš„æ‰€æœ‰åŠŸèƒ½ç‚¹ï¼Œä¾›å¼€å‘å›¢é˜Ÿå®¡æ ¸å’Œè·Ÿè¸ªã€‚

**v0.3.1 å˜æ›´æ‘˜è¦**:
- âœ… å®Œæˆ Stabilization Sprint (12/13 tasks, 92.3%)
- âœ… æ¶æ„å†³ç­– AD-001: éªŒè¯å±‚è´£ä»»åˆ†ç¦» â†’ `docs/architecture/VALIDATION_LAYERS.md`
- âœ… ç»Ÿä¸€ Schema Validator Service (Layer 1) â†’ `agentos/core/verify/schema_validator_service.py`
- âœ… æ–°å¢ DryExecutorValidator (Layer 3) â†’ `agentos/core/executor_dry/validator.py`
- âœ… æ¸…ç©ºæ ¸å¿ƒ TODO: 19 â†’ 7 å‰©ä½™ (P1: 2 WebUI, P2: 2 WebUI, P3: 3 WebUI)

---

## ğŸ“‹ å›¾ä¾‹è¯´æ˜

- âœ… **å·²å®Œæ•´å®ç°** - åŠŸèƒ½å·²å®ç°ä¸”ç»è¿‡æµ‹è¯•
- â³ **å¾…å®ç°/å¾…å®Œå–„** - ä»£ç ä¸­æ ‡è®°ä¸º TODO æˆ–å°šæœªå®ç°
- ğŸ”§ **éƒ¨åˆ†å®ç°** - æ ¸å¿ƒåŠŸèƒ½å·²å®ç°ï¼Œä½†å­˜åœ¨å¾…å®Œå–„é¡¹

---

## ä¸€ã€æ ¸å¿ƒæ¶æ„ç³»ç»Ÿ

### 1.1 ä»»åŠ¡ç®¡ç†ç³»ç»Ÿ (Task System)

**æ–‡ä»¶ä½ç½®**: `agentos/core/task/`

#### âœ… å·²å®ç°åŠŸèƒ½

1. **ä»»åŠ¡ CRUD æ“ä½œ**
   - æ–‡ä»¶: `manager.py` (å®Œæ•´å®ç°)
   - åŠŸèƒ½ç‚¹:
     - åˆ›å»ºä»»åŠ¡ (`create_task`)
     - æŸ¥è¯¢ä»»åŠ¡ (`get_task`, `get_task_by_session`)
     - æ›´æ–°ä»»åŠ¡çŠ¶æ€ (`update_task_status`)
     - åˆ é™¤ä»»åŠ¡ (`delete_task`)
     - åˆ—å‡ºæ‰€æœ‰ä»»åŠ¡ (`list_tasks`)

2. **ä»»åŠ¡è¡€ç»Ÿè¿½è¸ª (Task Lineage)**
   - æ–‡ä»¶: `manager.py` + `models.py`
   - åŠŸèƒ½ç‚¹:
     - æ·»åŠ è¡€ç»Ÿæ¡ç›® (`add_lineage`)
     - æŸ¥è¯¢ä»»åŠ¡å†å² (`get_lineage`)
     - è¡€ç»Ÿæ¡ç›®ç±»å‹æ”¯æŒ: `nl_request`, `intent`, `coordinator_run`, `execution_request`, `commit`

3. **ä»»åŠ¡è¿½è¸ª (Task Trace)**
   - æ–‡ä»¶: `trace_builder.py` + `models.py`
   - åŠŸèƒ½ç‚¹:
     - èšåˆæŸ¥è¯¢ä»»åŠ¡å®Œæ•´è¿½è¸ª (`build_trace`)
     - å…³è”æ‰€æœ‰è¡€ç»Ÿæ¡ç›®
     - ç”Ÿæˆä»»åŠ¡æ—¶é—´çº¿

4. **è¿è¡Œæ¨¡å¼ (Run Mode)**
   - æ–‡ä»¶: `run_mode.py`
   - æ”¯æŒçš„æ¨¡å¼:
     - `interactive` - æ¯ä¸ªé˜¶æ®µéœ€ç¡®è®¤
     - `assisted` - é»˜è®¤è‡ªåŠ¨ï¼Œå…³é”®ç‚¹æš‚åœ
     - `autonomous` - å…¨è‡ªåŠ¨è¿è¡Œ

5. **ä»»åŠ¡æ•°æ®æ¨¡å‹**
   - æ–‡ä»¶: `models.py`
   - æ¨¡å‹:
     - `Task` - ä»»åŠ¡ä¸»æ¨¡å‹ (ULID ID, çŠ¶æ€æœº, å…ƒæ•°æ®)
     - `TaskLineageEntry` - è¡€ç»Ÿæ¡ç›®
     - `TaskTrace` - ä»»åŠ¡è¿½è¸ªèšåˆ

#### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹ï¼ˆä»»åŠ¡ç³»ç»Ÿå·²å®Œæ•´å®ç°ï¼‰

---

### 1.2 ä¸‰å±‚æ‰§è¡Œæ¶æ„

#### âœ… å·²å®ç°åŠŸèƒ½

**Layer 1: Run Mode (äººæœºå…³ç³»å±‚)**
- æ–‡ä»¶: `agentos/core/task/run_mode.py`
- ä¸‰ç§è¿è¡Œæ¨¡å¼å®Œæ•´å®ç°
- ä¸ Pause Gate é›†æˆ

**Layer 2: Execution Mode (ç³»ç»Ÿé˜¶æ®µå±‚)**
- æ–‡ä»¶: `agentos/core/mode/mode.py`
- ä¸‰ç§æ‰§è¡Œæ¨¡å¼:
  - `implementation` - å®ç°æ¨¡å¼ (å…è®¸ diff/commit)
  - `design` - è®¾è®¡æ¨¡å¼ (ä»…è§„åˆ’)
  - `chat` - èŠå¤©æ¨¡å¼ (å¯¹è¯)
- Mode Gate é—¨æ§å®ç°
- æ¨¡å¼åˆ‡æ¢é€»è¾‘

**Layer 3: Model Policy (ç®—åŠ›ç­–ç•¥å±‚)**
- æ–‡ä»¶: `agentos/core/mode/mode.py`
- å£°æ˜å¼æ¨¡å‹ç­–ç•¥
- æ”¯æŒå­—æ®µ:
  - `default_model`
  - `intent_model`
  - `planning_model`
  - `implementation_model`

#### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

### 1.3 æ‰§è¡Œå¼•æ“ (Executor Engine)

**æ–‡ä»¶ä½ç½®**: `agentos/core/executor/`

#### âœ… å·²å®ç°åŠŸèƒ½

1. **æ‰§è¡Œç¼–æ’å¼•æ“**
   - æ–‡ä»¶: `executor_engine.py` (1,068 è¡Œ)
   - åŠŸèƒ½ç‚¹:
     - æ‰§è¡Œ Open Plan
     - æ²™ç®±ç¯å¢ƒç®¡ç†
     - å®¡æŸ¥é—¨æ§é›†æˆ
     - å®¡è®¡æ—¥å¿—è®°å½•
     - Rollback ç®¡ç†
     - é”ç®¡ç†
     - Diff éªŒè¯
     - Run Tape ç”Ÿæˆ

2. **æ²™ç®±ç¯å¢ƒ**
   - æ–‡ä»¶: `sandbox.py`
   - åŠŸèƒ½ç‚¹:
     - æ–‡ä»¶ç³»ç»Ÿéš”ç¦»
     - ç¯å¢ƒå˜é‡æ§åˆ¶
     - èµ„æºé™åˆ¶

3. **å®‰å…¨æ£€æŸ¥**
   - æ–‡ä»¶: `allowlist.py`
   - ç™½åå•éªŒè¯

4. **å®¡æŸ¥é—¨æ§ (Review Gate)**
   - æ–‡ä»¶: `review_gate.py`
   - é«˜é£é™©æ“ä½œå®¡æŸ¥

5. **å®¡è®¡æ—¥å¿— (Audit Logger)**
   - æ–‡ä»¶: `audit_logger.py`
   - æ‰€æœ‰æ‰§è¡ŒåŠ¨ä½œè®°å½•

6. **DAG è°ƒåº¦å™¨**
   - æ–‡ä»¶: `dag_scheduler.py`
   - ä»»åŠ¡ä¾èµ–è°ƒåº¦

7. **Sandbox ç­–ç•¥åŠ è½½å™¨**
   - æ–‡ä»¶: `sandbox_policy.py`
   - ç­–ç•¥éªŒè¯å’ŒåŠ è½½

#### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

### 1.4 å¹²è¿è¡Œæ‰§è¡Œå™¨ (Dry Executor)

**æ–‡ä»¶ä½ç½®**: `agentos/core/executor_dry/`

#### âœ… å·²å®ç°åŠŸèƒ½

1. **å¹²è¿è¡Œç¼–æ’å¼•æ“**
   - æ–‡ä»¶: `dry_executor.py`
   - åŠŸèƒ½ç‚¹:
     - ç”Ÿæˆ Open Plan (æ— å®é™…æ‰§è¡Œ)
     - æ‰§è¡Œå›¾æ„å»º
     - é£é™©è¯„ä¼°
     - è¾“å‡ºå†»ç»“ (checksum + lineage)

2. **æ‰§è¡Œå›¾æ„å»ºå™¨**
   - æ–‡ä»¶: `graph_builder.py`
   - ExecutionGraph ç”Ÿæˆ

3. **è¡¥ä¸è§„åˆ’å™¨**
   - æ–‡ä»¶: `patch_planner.py`
   - è¡¥ä¸è®¡åˆ’ç”Ÿæˆ

4. **æäº¤è§„åˆ’å™¨**
   - æ–‡ä»¶: `commit_planner.py`
   - æäº¤è®¡åˆ’ç”Ÿæˆ

5. **Open Plan æ„å»ºå™¨**
   - æ–‡ä»¶: `open_plan_builder.py`
   - å£°æ˜å¼è®¡åˆ’æ„å»º

6. **Open Plan éªŒè¯å™¨ (Layer 2: Business Rules)**
   - æ–‡ä»¶: `open_plan_verifier.py` (418 è¡Œ)
   - ç»“æ„éªŒè¯
   - ä¸šåŠ¡è§„åˆ™éªŒè¯ (BR001-BR007)
   - è¯­ä¹‰ä¸€è‡´æ€§æ£€æŸ¥

7. **Dry Executor Validator (Layer 3: RED LINE)** âœ¨ v0.3.1 æ–°å¢
   - æ–‡ä»¶: `validator.py` â†’ `agentos/core/executor_dry/validator.py`
   - åŠŸèƒ½ç‚¹:
     - ç»Ÿä¸€ RED LINE æ‰§è¡Œå…¥å£ (DE1-DE6)
     - è·¯å¾„ä¼ªé€ æ£€æµ‹ (DE3)
     - è¯æ®å¼•ç”¨å¼ºåˆ¶ (DE4)
     - é£é™©å®¡æŸ¥å¼ºåˆ¶ (DE5)
     - Checksum + Lineage éªŒè¯ (DE6)
     - é”™è¯¯æ¶ˆæ¯æ ‡è®°å±‚çº§æ¥æº

8. **Schema éªŒè¯å™¨å…¼å®¹æ€§é‡æ„** âœ… v0.3.1 å®Œæˆ
   - åŸæ–‡ä»¶: `scripts/adapters/schema_validator_compat.py` (å·²å¼ƒç”¨)
   - é‡æ„ä¸º: `agentos/core/verify/schema_validator_service.py`
   - è¿ç§»å†…å®¹:
     - `agentos/cli/dry_executor.py` ä¸­çš„ schema éªŒè¯é€»è¾‘
     - `agentos/cli/intent_builder.py` ä¸­çš„ schema éªŒè¯é€»è¾‘
   - å®Œæˆäº: Task S-01

#### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

### 1.5 åè°ƒå™¨ (Coordinator Engine)

**æ–‡ä»¶ä½ç½®**: `agentos/core/coordinator/`

#### âœ… å·²å®ç°åŠŸèƒ½

1. **åè°ƒå™¨çŠ¶æ€æœºé©±åŠ¨ (v0.9.2)**
   - æ–‡ä»¶: `engine.py`
   - åŠŸèƒ½ç‚¹:
     - 15 ä¸ªçŠ¶æ€æµè½¬
     - æ„å›¾æ¥æ”¶ â†’ é¢„æ£€æŸ¥ â†’ ä¸Šä¸‹æ–‡æ„å»º â†’ è§„åˆ™è¯„ä¼° â†’ å›¾è‰ç¨¿ â†’ æœ€ç»ˆåŒ–
     - è¾“å‡ºå†»ç»“ (checksum)
     - RED LINE: ä»…è§„åˆ’ï¼Œä¸æ‰§è¡Œ

2. **æ„å›¾è§£æå™¨**
   - æ–‡ä»¶: `intent_parser.py`
   - è‡ªç„¶è¯­è¨€è§£æ

3. **å›¾æ„å»ºå™¨**
   - æ–‡ä»¶: `graph_builder.py`
   - æ‰§è¡Œå›¾ç”Ÿæˆ

4. **æ¨¡å‹è·¯ç”±å™¨**
   - æ–‡ä»¶: `model_router.py`
   - å¤šæ¨¡å‹è·¯ç”±

5. **é—®é¢˜ç®¡ç†å™¨**
   - æ–‡ä»¶: `question_governor.py`
   - é—®é¢˜ç”Ÿæˆå’Œç®¡ç†

6. **è§„åˆ™è£å®šå™¨**
   - æ–‡ä»¶: `rules_adjudicator.py`
   - è§„åˆ™éªŒè¯å’Œè£å®š

#### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

### 1.6 è¯„ä¼°å™¨ (Evaluator Engine)

**æ–‡ä»¶ä½ç½®**: `agentos/core/evaluator/`

#### âœ… å·²å®ç°åŠŸèƒ½

1. **è¯„ä¼°å¼•æ“ (v0.9.3)**
   - æ–‡ä»¶: `engine.py` â†’ `agentos/core/evaluator/engine.py`
   - å·¥ä½œæµ:
     - åŠ è½½å’Œè§„èŒƒåŒ–æ„å›¾
     - æ£€æµ‹å†²çª
     - é£é™©æ¯”è¾ƒ
     - åˆå¹¶è§„åˆ’
     - è¾“å‡ºå†»ç»“

2. **å†²çªæ£€æµ‹å™¨** âœ¨ v0.3.1 å¢å¼º
   - æ–‡ä»¶: `conflict_detector.py` â†’ `agentos/core/evaluator/conflict_detector.py`
   - åŠŸèƒ½ç‚¹:
     - æ–‡ä»¶çº§å†²çªæ£€æµ‹
     - è·¯å¾„å†²çªæ£€æµ‹
     - é”å†²çªæ£€æµ‹ (exact + glob pattern overlap)
     - å·¥å…·å†²çªæ£€æµ‹
     - é¢„ç®—å†²çªæ£€æµ‹ (max_cost_usd, max_tokens æ€»å’Œ) âœ… Task E-01
     - é”èŒƒå›´å†²çªæ£€æµ‹ (glob pattern overlap) âœ… Task E-02

3. **åˆå¹¶è§„åˆ’å™¨**
   - æ–‡ä»¶: `merge_planner.py` â†’ `agentos/core/evaluator/merge_planner.py`
   - æ„å›¾åˆå¹¶ç­–ç•¥

4. **æ„å›¾è§„èŒƒåŒ–å™¨**
   - æ–‡ä»¶: `intent_normalizer.py` â†’ `agentos/core/evaluator/intent_normalizer.py`
   - æ„å›¾æ ‡å‡†åŒ–

5. **é£é™©æ¯”è¾ƒå™¨**
   - æ–‡ä»¶: `risk_comparator.py` â†’ `agentos/core/evaluator/risk_comparator.py`
   - é£é™©è¯„ä¼°å’Œæ¯”è¾ƒ

#### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## äºŒã€æ„å›¾æ„å»ºç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `agentos/core/intent_builder/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **æ„å›¾æ„å»ºå™¨**
   - æ–‡ä»¶: `builder.py` (571 è¡Œ)
   - åŠŸèƒ½ç‚¹:
     - è‡ªç„¶è¯­è¨€ â†’ ExecutionIntent
     - æ³¨å†Œè¡¨æŸ¥è¯¢é›†æˆ
     - é—®é¢˜ç”Ÿæˆ
     - è¯æ®æå–

2. **è‡ªç„¶è¯­è¨€è§£æå™¨**
   - æ–‡ä»¶: `nl_parser.py`
   - NL è§£æé€»è¾‘

3. **é—®é¢˜ç”Ÿæˆå™¨**
   - æ–‡ä»¶: `questions.py`
   - æ¾„æ¸…æ€§é—®é¢˜ç”Ÿæˆ

4. **æ³¨å†Œè¡¨æŸ¥è¯¢å™¨**
   - æ–‡ä»¶: `registry_query.py`
   - å†…å®¹æ³¨å†Œè¡¨æŸ¥è¯¢

5. **è¯æ®æå–å™¨**
   - æ–‡ä»¶: `evidence.py`
   - è¯æ®å¼•ç”¨ç®¡ç†

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹ï¼ˆSchema éªŒè¯å™¨é‡æ„å·²å®Œæˆäº v0.3.1 Task S-01ï¼‰

---

## ä¸‰ã€çŸ¥è¯†åº“ç³»ç»Ÿ

### 3.1 é¡¹ç›®çŸ¥è¯†åº“ (Project KB)

**æ–‡ä»¶ä½ç½®**: `agentos/core/project_kb/`

#### âœ… å·²å®ç°åŠŸèƒ½

1. **ç»Ÿä¸€æœåŠ¡é—¨é¢** âœ¨ v0.3.1 å¢å¼º
   - æ–‡ä»¶: `service.py` â†’ `agentos/core/project_kb/service.py`
   - åŠŸèƒ½ç‚¹:
     - ç´¢å¼•ç®¡ç†
     - æœç´¢æ¥å£
     - æ–‡æ¡£æ‰«æ
     - ç»Ÿè®¡æŸ¥è¯¢ (count_chunks_by_source, get_chunks_stats_by_source) âœ… Task K-01

2. **FTS5 å…¨æ–‡ç´¢å¼•å™¨** âœ¨ v0.3.1 å¢å¼º
   - æ–‡ä»¶: `indexer.py` â†’ `agentos/core/project_kb/indexer.py`
   - åŠŸèƒ½ç‚¹:
     - FTS5 å¯ç”¨æ€§æ£€æµ‹ (Gate #1)
     - å¢é‡ç´¢å¼•æ›´æ–°
     - æ–‡æ¡£åˆ é™¤æ¸…ç†
     - WAL æ¨¡å¼ä¼˜åŒ–
     - é‡å»ºå¹‚ç­‰æ€§ (Gate #2)
     - åˆ†å—ç»Ÿè®¡ API (count_chunks_by_source, get_chunks_stats_by_source) âœ… Task K-01

3. **æœç´¢å™¨**
   - æ–‡ä»¶: `searcher.py` â†’ `agentos/core/project_kb/searcher.py`
   - FTS5 æŸ¥è¯¢å°è£…

4. **Markdown åˆ†å—å™¨**
   - æ–‡ä»¶: `chunker.py` â†’ `agentos/core/project_kb/chunker.py`
   - è¯­ä¹‰åˆ†å—ç®—æ³•

5. **æ–‡æ¡£æ‰«æå™¨**
   - æ–‡ä»¶: `scanner.py` â†’ `agentos/core/project_kb/scanner.py`
   - é¡¹ç›®æ–‡æ¡£æ‰«æ

6. **å‘é‡åµŒå…¥æ”¯æŒ**
   - ç›®å½•: `embedding/` â†’ `agentos/core/project_kb/embedding/`
   - æ–‡ä»¶:
     - `factory.py` - åµŒå…¥å·¥å‚
     - `local_tfidf.py` - TF-IDF æœ¬åœ°åµŒå…¥

#### â³ å¾…å®ç°åŠŸèƒ½

1. **OpenAI åµŒå…¥ Provider** (ä¼˜å…ˆçº§: P3)
   - æ–‡ä»¶: `embedding/factory.py:37`
   - TODO: å®ç° OpenAI embedding æ”¯æŒ

2. **é«˜çº§æœç´¢è¯­æ³•** (ä¼˜å…ˆçº§: P3)
   - æ–‡ä»¶: `searcher.py:89`
   - TODO: æ”¯æŒçŸ­è¯­æœç´¢ã€å¸ƒå°”è¿ç®—ç¬¦

---

### 3.2 å†…å­˜ç®¡ç†ç³»ç»Ÿ (Memory System)

**æ–‡ä»¶ä½ç½®**: `agentos/core/memory/`

#### âœ… å·²å®ç°åŠŸèƒ½

1. **å†…å­˜æœåŠ¡**
   - æ–‡ä»¶: `service.py` â†’ `agentos/core/memory/service.py`
   - å†…å­˜é¡¹ç®¡ç†

2. **ä¸Šä¸‹æ–‡é¢„ç®—ç®¡ç†**
   - æ–‡ä»¶: `budgeter.py` â†’ `agentos/core/memory/budgeter.py`
   - Token é¢„ç®—æ§åˆ¶

3. **å‹ç¼©å™¨ (Memory Compactor)** âœ¨ v0.3.1 å¢å¼º
   - æ–‡ä»¶: `compactor.py` â†’ `agentos/core/memory/compactor.py`
   - åŠŸèƒ½ç‚¹:
     - å†…å­˜å‹ç¼©é€»è¾‘
     - å¯æ’æ‹”æ‘˜è¦ç­–ç•¥æ¥å£ (SummaryStrategy) âœ… Task M-01
       - `SimpleSummaryStrategy` (ç®€å•æ‹¼æ¥)
       - `LLMSummaryStrategy` (LLM ç”Ÿæˆæ‘˜è¦)
     - å¯é…ç½®å†…å®¹åˆå¹¶ç­–ç•¥ (merge_strategy) âœ… Task M-02

4. **è¡°å‡ç­–ç•¥**
   - æ–‡ä»¶: `decay.py` â†’ `agentos/core/memory/decay.py`
   - æ—¶é—´è¡°å‡ç®—æ³•

5. **å»é‡å™¨**
   - æ–‡ä»¶: `deduplicator.py` â†’ `agentos/core/memory/deduplicator.py`
   - é‡å¤å†…å®¹å»é‡

#### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## å››ã€å®‰å…¨é—¨æ§ç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `agentos/core/gates/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **Pause Gate (æš‚åœé—¨æ§)** - V1 é“å¾‹
   - æ–‡ä»¶: `pause_gate.py`
   - åŠŸèƒ½ç‚¹:
     - RED LINE: ä»…å…è®¸åœ¨ `open_plan` æ£€æŸ¥ç‚¹æš‚åœ
     - PauseState æšä¸¾
     - PauseCheckpoint æšä¸¾
     - PauseMetadata æ•°æ®ç±»
     - V1 éªŒè¯é€»è¾‘

2. **è¿è¡Œæ—¶æ‰§è¡Œå™¨**
   - æ–‡ä»¶: `runtime_enforcer.py`
   - è¿è¡Œæ—¶è§„åˆ™æ‰§è¡Œ

3. **Agent çº¢çº¿éªŒè¯**
   - æ–‡ä»¶: `validate_agent_redlines.py`
   - Agent è¡Œä¸ºçº¦æŸéªŒè¯

4. **å‘½ä»¤çº¢çº¿éªŒè¯**
   - æ–‡ä»¶: `validate_command_redlines.py`
   - å‘½ä»¤å®‰å…¨éªŒè¯

5. **è§„åˆ™çº¢çº¿éªŒè¯**
   - æ–‡ä»¶: `validate_rule_redlines.py`
   - è§„åˆ™ä¸€è‡´æ€§éªŒè¯

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## äº”ã€èŠå¤©ç³»ç»Ÿ (Chat System)

**æ–‡ä»¶ä½ç½®**: `agentos/core/chat/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **èŠå¤©å¼•æ“**
   - æ–‡ä»¶: `engine.py` â†’ `agentos/core/chat/engine.py`
   - å¯¹è¯ç®¡ç†

2. **ä¸Šä¸‹æ–‡æ„å»ºå™¨** âœ¨ v0.3.1 å¢å¼º
   - æ–‡ä»¶: `context_builder.py` â†’ `agentos/core/chat/context_builder.py`
   - åŠŸèƒ½ç‚¹:
     - ä¸Šä¸‹æ–‡çª—å£ç®¡ç†
     - æ‘˜è¦æ—¶æ•ˆæ€§æ£€æŸ¥ (message_count, token_threshold, time_elapsed) âœ… Task C-01

3. **èŠå¤©æœåŠ¡**
   - æ–‡ä»¶: `service.py` â†’ `agentos/core/chat/service.py`
   - èŠå¤© API å°è£…

4. **æ‘˜è¦ç”Ÿæˆå™¨**
   - æ–‡ä»¶: `summarizer.py` â†’ `agentos/core/chat/summarizer.py`
   - å¯¹è¯æ‘˜è¦

5. **å¤„ç†å™¨é›†åˆ**
   - ç›®å½•: `handlers/` â†’ `agentos/core/chat/handlers/`
   - å„ç±»æ¶ˆæ¯å¤„ç†å™¨

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## å…­ã€å†…å®¹ç®¡ç†ç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `agentos/core/content/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **ç»Ÿä¸€é—¨é¢**
   - æ–‡ä»¶: `facade.py`
   - å†…å®¹ç®¡ç†ç»Ÿä¸€æ¥å£

2. **å†…å®¹æ³¨å†Œè¡¨**
   - æ–‡ä»¶: `registry.py` (375 è¡Œ)
   - å†…å®¹æ³¨å†Œå’ŒæŸ¥è¯¢

3. **æ¿€æ´»ç®¡ç†**
   - æ–‡ä»¶: `activation.py`
   - å†…å®¹æ¿€æ´»çŠ¶æ€

4. **è¡€ç»Ÿè¿½è¸ª**
   - æ–‡ä»¶: `lineage.py`
   - å†…å®¹è¡€ç»Ÿç®¡ç†

5. **Schema åŠ è½½å™¨**
   - æ–‡ä»¶: `schema_loader.py`
   - JSON Schema åŠ è½½

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## ä¸ƒã€æ¨¡å‹ç®¡ç†ç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `agentos/core/model/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **æ¨¡å‹æ³¨å†Œè¡¨**
   - æ–‡ä»¶: `model_registry.py` (507 è¡Œ)
   - åŠŸèƒ½ç‚¹:
     - æ¨¡å‹æ³¨å†Œ
     - æ¨¡å‹æŸ¥è¯¢
     - ç‰ˆæœ¬ç®¡ç†

2. **æ¨¡å‹è°ƒç”¨å™¨**
   - æ–‡ä»¶: `model_invoker.py`
   - ç»Ÿä¸€è°ƒç”¨æ¥å£

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## å…«ã€åˆ†å¸ƒå¼é”ç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `agentos/core/locks/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **ä»»åŠ¡é”**
   - æ–‡ä»¶: `task_lock.py` (376 è¡Œ)
   - ä»»åŠ¡çº§é”ç®¡ç†

2. **æ–‡ä»¶é”**
   - æ–‡ä»¶: `file_lock.py` (433 è¡Œ)
   - æ–‡ä»¶çº§é”ç®¡ç†

3. **é”ä»¤ç‰Œ**
   - æ–‡ä»¶: `lock_token.py`
   - ä»¤ç‰Œç”Ÿæˆå’ŒéªŒè¯

4. **å¼‚å¸¸å®šä¹‰**
   - æ–‡ä»¶: `exceptions.py`
   - é”ç›¸å…³å¼‚å¸¸

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## ä¹ã€åŸºç¡€è®¾æ–½é›†æˆ

**æ–‡ä»¶ä½ç½®**: `agentos/core/infra/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **Git å®¢æˆ·ç«¯**
   - æ–‡ä»¶: `git_client.py`
   - Git æ“ä½œå°è£…

2. **å®¹å™¨å®¢æˆ·ç«¯**
   - æ–‡ä»¶: `container_client.py`
   - Docker æ“ä½œå°è£…

3. **å‡­è¯ç®¡ç†å™¨**
   - æ–‡ä»¶: `credentials_manager.py`
   - å‡­è¯å­˜å‚¨å’ŒæŸ¥è¯¢

4. **å·¥å…·æ‰§è¡Œå™¨**
   - æ–‡ä»¶: `tool_executor.py`
   - å·¥å…·æ‰§è¡Œå°è£…

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## åã€Schema å®šä¹‰ç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `agentos/schemas/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **Open Plan Schema**
   - æ–‡ä»¶: `open_plan.schema.json`
   - å£°æ˜å¼è®¡åˆ’ç»“æ„å®šä¹‰

2. **æ‰§è¡Œå›¾ Schema**
   - æ–‡ä»¶: `execution_graph.schema.json`
   - æ‰§è¡Œå›¾ç»“æ„å®šä¹‰

3. **å®¡æŸ¥åŒ… Schema**
   - æ–‡ä»¶: `review_pack.schema.json`
   - å®¡æŸ¥æ•°æ®ç»“æ„

4. **å¤±è´¥åŒ… Schema**
   - æ–‡ä»¶: `failure_pack.schema.json`
   - å¤±è´¥ä¿¡æ¯ç»“æ„

5. **Dry Execution Result Schema**
   - æ–‡ä»¶: `executor/dry_execution_result.schema.json`
   - å¹²è¿è¡Œç»“æœç»“æ„

6. **Coordinator Run Tape Schema**
   - æ–‡ä»¶: `coordinator/coordinator_run_tape.schema.json`
   - åè°ƒå™¨è¿è¡Œè®°å½•

7. **Intent Evaluation Result Schema**
   - æ–‡ä»¶: `evaluator/intent_evaluation_result.schema.json`
   - è¯„ä¼°ç»“æœç»“æ„

8. **Open Plan éªŒè¯å™¨**
   - æ–‡ä»¶: `open_plan.py` (377 è¡Œ)
   - ç»“æ„éªŒè¯å’Œ Action éªŒè¯

9. **åŠ¨ä½œéªŒè¯å™¨**
   - æ–‡ä»¶: `action_validators.py`
   - å„ç±» Action éªŒè¯

10. **ç»“æ„éªŒè¯å™¨**
    - æ–‡ä»¶: `structural_validator.py`
    - ç»“æ„ä¸€è‡´æ€§éªŒè¯

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## åä¸€ã€CLI å‘½ä»¤ç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `agentos/cli/`

### âœ… å·²å®ç°åŠŸèƒ½

#### æ ¸å¿ƒå‘½ä»¤ (27 ä¸ªå‘½ä»¤æ–‡ä»¶)

1. **main.py** - CLI ä¸»å…¥å£
   - å‘½ä»¤æ³¨å†Œ
   - å¥åº·æ£€æŸ¥é›†æˆ
   - å›½é™…åŒ–æ”¯æŒ

2. **init.py** - åˆå§‹åŒ–å‘½ä»¤
   - æ•°æ®åº“åˆ›å»º
   - Schema åŠ è½½

3. **interactive.py** - äº¤äº’å¼æ¨¡å¼
   - Task Control Plane
   - TUI ç•Œé¢ï¼ˆå·²ç§»é™¤æ—§å®ç°ï¼Œå‡†å¤‡è¿ç§»åˆ° WebUIï¼‰

4. **task.py** - ä»»åŠ¡ç®¡ç†å‘½ä»¤
   - task create
   - task list
   - task show
   - task update
   - task delete

5. **pipeline.py** - æµæ°´çº¿æ§åˆ¶
   - pipeline run
   - pipeline status

6. **executor.py** - æ‰§è¡Œå™¨å‘½ä»¤
   - exec run
   - exec status

7. **dry_executor.py** - å¹²è¿è¡Œå‘½ä»¤
   - dry-run plan
   - dry-run verify

8. **evaluator.py** - è¯„ä¼°å™¨å‘½ä»¤
   - evaluator run
   - evaluator compare

9. **intent_builder.py** - æ„å›¾æ„å»ºå‘½ä»¤
   - builder build
   - builder parse

10. **content.py** - å†…å®¹ç®¡ç†
    - content register
    - content list
    - content activate

11. **memory.py** - å†…å­˜ç®¡ç†
    - memory add
    - memory search
    - memory compact

12. **kb.py** - çŸ¥è¯†åº“æ“ä½œ
    - kb index
    - kb search
    - kb stats

13. **project.py** - é¡¹ç›®ç®¡ç†
    - project init
    - project info

14. **coordinate.py** - åè°ƒå™¨å‘½ä»¤
    - coordinate run

15. **answers.py** - ç­”æ¡ˆç®¡ç†
    - answers apply
    - answers validate

16. **tools.py** - å·¥å…·ç®¡ç†
    - tool list
    - tool register

17. **run.py** - ä»»åŠ¡è¿è¡Œ âœ¨ v0.3.1 å¢å¼º
    - æ–‡ä»¶: `agentos/cli/run.py`
    - run execute
    - è¿è¡Œæ—¶é•¿è®¡ç®—å’Œæ ¼å¼åŒ– (_format_duration) âœ… Task CLI-01

18. **migrate.py** - æ•°æ®åº“è¿ç§»
    - migrate upgrade

19. **health.py** - å¥åº·æ£€æŸ¥
    - Schema ç‰ˆæœ¬æ£€æŸ¥

20. **scan.py** - æ‰«æå‘½ä»¤
    - scan project

21. **generate.py** - ç”Ÿæˆå‘½ä»¤
    - generate code

22. **verify.py** - éªŒè¯å‘½ä»¤
    - verify plan

23. **orchestrate.py** - ç¼–æ’å‘½ä»¤
    - orchestrate run

24. **replay.py** - é‡æ”¾å‘½ä»¤
    - replay task

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## åäºŒã€æ•°æ®å­˜å‚¨ç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `agentos/store/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **æ•°æ®åº“æ³¨å†Œè¡¨** (v0.6 Schema)
   - æ–‡ä»¶: `registry.sqlite`
   - è¡¨ç»“æ„:
     - `tasks` - ä»»åŠ¡ä¸»è¡¨
     - `task_lineage` - ä»»åŠ¡è¡€ç»Ÿ
     - `task_sessions` - ä¼šè¯ç®¡ç†
     - `task_agents` - Agent ä¿¡æ¯
     - `task_audits` - å®¡è®¡æ—¥å¿—
     - `content_registry` - å†…å®¹æ³¨å†Œ
     - `policy_lineage` - ç­–ç•¥è¡€ç»Ÿï¼ˆåªè¯»ï¼‰
     - `memory_items` - è®°å¿†é¡¹ï¼ˆåªè¯»ï¼‰
     - `projects` - é¡¹ç›®ä¿¡æ¯ï¼ˆLegacyï¼‰
     - `runs` - è¿è¡Œè®°å½•ï¼ˆLegacyï¼‰
     - `artifacts` - å·¥ä»¶å­˜å‚¨ï¼ˆLegacyï¼‰

2. **Schema ç®¡ç†**
   - æ–‡ä»¶: `schema_v06.sql`
   - å®Œæ•´çš„ v0.6 Schema å®šä¹‰

3. **æ•°æ®åº“è¿æ¥ç®¡ç†**
   - æ–‡ä»¶: `__init__.py`
   - è¿æ¥æ± ç®¡ç†

4. **è¿ç§»ç³»ç»Ÿ**
   - æ–‡ä»¶: `migrations.py`
   - åŠŸèƒ½ç‚¹:
     - åŠ¨æ€ç‰ˆæœ¬æ‰«æ
     - è‡ªåŠ¨è¿ç§»é“¾æ„å»º
     - è¯­ä¹‰ç‰ˆæœ¬æ’åº
     - å¹‚ç­‰æ€§ä¿è¯

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## åä¸‰ã€ç¼–æ’ç³»ç»Ÿ (Orchestrator)

**æ–‡ä»¶ä½ç½®**: `agentos/core/orchestrator/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **ç¼–æ’å™¨ä¸»æ¨¡å—** âœ¨ v0.3.1 å¢å¼º
   - æ–‡ä»¶: `rebase.py` â†’ `agentos/core/orchestrator/rebase.py`
   - åŠŸèƒ½ç‚¹:
     - åŸºç¡€ç¼–æ’é€»è¾‘
     - æ–‡ä»¶å˜æ›´æ£€æµ‹ (git diff + file_locks + mtime fallback) âœ… Task O-01
     - é‡è§„åˆ’é€»è¾‘ (affected step identification + replan strategy) âœ… Task O-02

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## åå››ã€å·¥å…·æ‰©å±•ç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `agentos/ext/tools/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **åŸºç¡€é€‚é…å™¨**
   - æ–‡ä»¶: `base_adapter.py`
   - ç»Ÿä¸€é€‚é…å™¨æ¥å£

2. **OpenAI Chat é€‚é…å™¨**
   - æ–‡ä»¶: `openai_chat_adapter.py`
   - OpenAI API é›†æˆ

3. **Claude CLI é€‚é…å™¨**
   - æ–‡ä»¶: `claude_cli_adapter.py`
   - Claude CLI é›†æˆ

4. **Ollama é€‚é…å™¨**
   - æ–‡ä»¶: `ollama_adapter.py`
   - Ollama æœ¬åœ° LLM æ”¯æŒ

5. **LM Studio é€‚é…å™¨**
   - æ–‡ä»¶: `lmstudio_adapter.py`
   - LM Studio é›†æˆ

6. **LLama CPP é€‚é…å™¨**
   - æ–‡ä»¶: `llamacpp_adapter.py`
   - LLama CPP é›†æˆ

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## åäº”ã€é¡¹ç›®é€‚é…å™¨

**æ–‡ä»¶ä½ç½®**: `agentos/adapters/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **åŸºç¡€é€‚é…å™¨**
   - æ–‡ä»¶: `base.py`
   - é¡¹ç›®é€‚é…å™¨åŸºç±»

2. **.NET é€‚é…å™¨**
   - æ–‡ä»¶: `dotnet.py`
   - .NET é¡¹ç›®æ”¯æŒ

3. **Vite React é€‚é…å™¨**
   - æ–‡ä»¶: `vite_react.py`
   - Vite React é¡¹ç›®æ”¯æŒ

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## åå…­ã€å›½é™…åŒ–ç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `agentos/i18n/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **å¤šè¯­è¨€æ”¯æŒ**
   - ä¸­æ–‡ (zh)
   - è‹±æ–‡ (en)

2. **è¯­è¨€åˆ‡æ¢**
   - åŠ¨æ€è¯­è¨€åŠ è½½

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## åä¸ƒã€MemoryOS ç‹¬ç«‹æ¨¡å—

**æ–‡ä»¶ä½ç½®**: `memoryos/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **æ ¸å¿ƒå­˜å‚¨**
   - æ–‡ä»¶: `core/store.py`
   - å†…å­˜å­˜å‚¨æ¥å£

2. **å®¢æˆ·ç«¯**
   - æ–‡ä»¶: `core/client.py`
   - MemoryOS å®¢æˆ·ç«¯

3. **SQLite åç«¯**
   - æ–‡ä»¶: `backends/sqlite_store.py`
   - SQLite å­˜å‚¨å®ç°

4. **CLI æ¥å£**
   - æ–‡ä»¶: `cli/main.py`
   - MemoryOS CLI å‘½ä»¤

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## åå…«ã€æµ‹è¯•ç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `tests/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **å•å…ƒæµ‹è¯•**
   - ç›®å½•: `unit/`
   - è¦†ç›–æ ¸å¿ƒæ¨¡å—

2. **é›†æˆæµ‹è¯•**
   - ç›®å½•: `integration/`
   - è·¨æ¨¡å—æµ‹è¯•

3. **ç«¯åˆ°ç«¯æµ‹è¯•**
   - ç›®å½•: `e2e/`
   - CLI E2E æµ‹è¯•

4. **åè°ƒå™¨æµ‹è¯•**
   - ç›®å½•: `coordinator/`
   - åè°ƒå™¨ä¸“é¡¹æµ‹è¯•

5. **é—¨æ§æµ‹è¯•**
   - ç›®å½•: `gates/`
   - å®‰å…¨é—¨æ§éªŒè¯

6. **åœºæ™¯æµ‹è¯•**
   - ç›®å½•: `scenarios/`
   - çœŸå®åœºæ™¯æ¨¡æ‹Ÿ

7. **Phase B é—¨æ§éªŒè¯**
   - æ–‡ä»¶: `gate_verification_phase_b.py`
   - Phase B å®Œæ•´éªŒè¯

8. **çƒŸé›¾æµ‹è¯•**
   - æ–‡ä»¶: `smoke_test_chat.py`
   - å¿«é€Ÿå¥åº·æ£€æŸ¥

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## åä¹ã€é…ç½®ç®¡ç†ç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `agentos/config/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **CLI è®¾ç½®ç®¡ç†**
   - æ–‡ä»¶: `cli_settings.py`
   - é…ç½®åŠ è½½å’Œä¿å­˜

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## äºŒåã€å…¶ä»–æ ¸å¿ƒæ¨¡å—

### 20.1 å­¦ä¹ ç®¡é“ (Learning Pipeline)

**æ–‡ä»¶ä½ç½®**: `agentos/core/learning/`

#### âœ… å·²å®ç°åŠŸèƒ½
- å­¦ä¹ ç®¡é“åŸºç¡€æ¡†æ¶

#### â³ å¾…å®ç°åŠŸèƒ½
- æš‚æ— å¾…å®ç°é¡¹

---

### 20.2 ä»£ç ç”Ÿæˆå™¨ (Generator)

**æ–‡ä»¶ä½ç½®**: `agentos/core/generator/`

#### âœ… å·²å®ç°åŠŸèƒ½
- ä»£ç ç”Ÿæˆæ¡†æ¶

#### â³ å¾…å®ç°åŠŸèƒ½
- æš‚æ— å¾…å®ç°é¡¹

---

### 20.3 æ•…éšœä¿®å¤ (Healing)

**æ–‡ä»¶ä½ç½®**: `agentos/core/healing/`

#### âœ… å·²å®ç°åŠŸèƒ½
- æ•…éšœä¿®å¤æ¡†æ¶

#### â³ å¾…å®ç°åŠŸèƒ½
- æš‚æ— å¾…å®ç°é¡¹

---

### 20.4 éªŒè¯å·¥å…· (Verify)

**æ–‡ä»¶ä½ç½®**: `agentos/core/verify/`

#### âœ… å·²å®ç°åŠŸèƒ½

1. **Schema Validator Service (Layer 1)** âœ¨ v0.3.1 æ–°å¢
   - æ–‡ä»¶: `schema_validator_service.py` â†’ `agentos/core/verify/schema_validator_service.py`
   - åŠŸèƒ½ç‚¹:
     - ç»Ÿä¸€ Schema éªŒè¯å…¥å£ (æ¶ˆé™¤ CLI/Core éªŒè¯ç¢ç‰‡åŒ–)
     - `validate_by_name()` - æŒ‰ schema åç§°éªŒè¯
     - `validate_by_path()` - æŒ‰ schema è·¯å¾„éªŒè¯
     - `validate_file_by_name()` - éªŒè¯æ–‡ä»¶ (æŒ‰åç§°)
     - `validate_file_by_path()` - éªŒè¯æ–‡ä»¶ (æŒ‰è·¯å¾„)
     - å®Œæ•´ JSON Schema éªŒè¯ (ç»“æ„æ­£ç¡®æ€§)
   - æ›¿ä»£: `scripts/adapters/schema_validator_compat.py` (å·²å¼ƒç”¨)

2. **Markdown Linter**
   - æ–‡ä»¶: `md_linter.py` â†’ `agentos/core/verify/md_linter.py`
   - åŠŸèƒ½ç‚¹:
     - TODO æ ‡è®°æ£€æµ‹
     - FIXME æ ‡è®°æ£€æµ‹
     - XXX æ ‡è®°æ£€æµ‹

#### â³ å¾…å®ç°åŠŸèƒ½
- æš‚æ— å¾…å®ç°é¡¹

---

### 20.5 å®¡æŸ¥åŒ…ç”Ÿæˆ (Review)

**æ–‡ä»¶ä½ç½®**: `agentos/core/review/`

#### âœ… å·²å®ç°åŠŸèƒ½
- å®¡æŸ¥åŒ…ç”Ÿæˆé€»è¾‘

#### â³ å¾…å®ç°åŠŸèƒ½
- æš‚æ— å¾…å®ç°é¡¹

---

### 20.6 ç­”æ¡ˆç®¡ç† (Answers)

**æ–‡ä»¶ä½ç½®**: `agentos/core/answers/`

#### âœ… å·²å®ç°åŠŸèƒ½

1. **ç­”æ¡ˆå­˜å‚¨**
   - æ–‡ä»¶: `answer_store.py`

2. **ç­”æ¡ˆåº”ç”¨å™¨**
   - æ–‡ä»¶: `answer_applier.py`

3. **ç­”æ¡ˆéªŒè¯å™¨**
   - æ–‡ä»¶: `answer_validator.py`

4. **å¤šè½®å¯¹è¯**
   - æ–‡ä»¶: `multiround.py` (437 è¡Œ)

#### â³ å¾…å®ç°åŠŸèƒ½
- æš‚æ— å¾…å®ç°é¡¹

---

### 20.7 è¿è¡Œå™¨ (Runner)

**æ–‡ä»¶ä½ç½®**: `agentos/core/runner/`

#### âœ… å·²å®ç°åŠŸèƒ½

1. **ä»»åŠ¡è¿è¡Œå™¨**
   - æ–‡ä»¶: `task_runner.py` (587 è¡Œ)
   - ä»»åŠ¡æ‰§è¡Œç¼–æ’

#### â³ å¾…å®ç°åŠŸèƒ½
- æš‚æ— å¾…å®ç°é¡¹

---

### 20.8 è°ƒåº¦å™¨ (Scheduler)

**æ–‡ä»¶ä½ç½®**: `agentos/core/scheduler/`

#### âœ… å·²å®ç°åŠŸèƒ½
- è°ƒåº¦å™¨åŸºç¡€æ¡†æ¶

#### â³ å¾…å®ç°åŠŸèƒ½
- æš‚æ— å¾…å®ç°é¡¹

---

### 20.9 ç­–ç•¥ç®¡ç† (Policy)

**æ–‡ä»¶ä½ç½®**: `agentos/core/policy/`

#### âœ… å·²å®ç°åŠŸèƒ½
- ç­–ç•¥ç®¡ç†æ¡†æ¶

#### â³ å¾…å®ç°åŠŸèƒ½
- æš‚æ— å¾…å®ç°é¡¹

---

### 20.10 å‘½ä»¤å¤„ç† (Command)

**æ–‡ä»¶ä½ç½®**: `agentos/core/command/`

#### âœ… å·²å®ç°åŠŸèƒ½
- å‘½ä»¤å¤„ç†æ¡†æ¶

#### â³ å¾…å®ç°åŠŸèƒ½
- æš‚æ— å¾…å®ç°é¡¹

---

### 20.11 LLM å®¢æˆ·ç«¯

**æ–‡ä»¶ä½ç½®**: `agentos/core/llm/`

#### âœ… å·²å®ç°åŠŸèƒ½
- LLM å®¢æˆ·ç«¯å°è£…

#### â³ å¾…å®ç°åŠŸèƒ½
- æš‚æ— å¾…å®ç°é¡¹

---

## äºŒåä¸€ã€è¾…åŠ©å·¥å…·å’Œè„šæœ¬

**æ–‡ä»¶ä½ç½®**: `scripts/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **å¼€æºé…ç½®æ¸…ç†**
   - æ–‡ä»¶: `scripts/opensource/sanitize_configs_enhanced.py`
   - æ•æ„Ÿä¿¡æ¯æ¸…ç†

2. **Schema éªŒè¯å™¨å…¼å®¹æ€§** (DEPRECATED)
   - æ–‡ä»¶: `scripts/adapters/schema_validator_compat.py`
   - å·²è¢« `SchemaValidatorService` æ›¿ä»£ (v0.3.1)

3. **Phase B é—¨æ§éªŒè¯**
   - æ–‡ä»¶: `scripts/gates/gate_verification_phase_b.py`

4. **V0.9.2 åè°ƒå™¨éš”ç¦»æµ‹è¯•** âœ¨ v0.3.1 å¢å¼º
   - æ–‡ä»¶: `scripts/gates/v092_gate_e_isolation.py`
   - åŠŸèƒ½ç‚¹:
     - çœŸå® CoordinatorEngine é›†æˆ âœ… Task G-01
     - éš”ç¦»ç¯å¢ƒéªŒè¯
     - æ— å…¨å±€çŠ¶æ€æ±¡æŸ“æ£€æŸ¥

5. **TL-R1-N1 è´Ÿé¢æµ‹è¯•**
   - æ–‡ä»¶: `scripts/gates/tl_r1_n1_negative.py`

### â³ å¾…å®ç°åŠŸèƒ½

- æš‚æ— å¾…å®ç°é¡¹

---

## äºŒåäºŒã€WebUI ç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `agentos/webui/`

### âœ… å·²å®ç°åŠŸèƒ½

#### M0: éª¨æ¶ä¸å¥åº·
1. **FastAPI ä¸»åº”ç”¨**
   - æ–‡ä»¶: `app.py`
   - FastAPI åº”ç”¨åˆå§‹åŒ–
   - é™æ€æ–‡ä»¶æœåŠ¡
   - Jinja2 æ¨¡æ¿æ¸²æŸ“

2. **Health API**
   - æ–‡ä»¶: `api/health.py`
   - ç³»ç»Ÿå¥åº·æ£€æŸ¥
   - ç»„ä»¶çŠ¶æ€ç›‘æ§
   - è¿›ç¨‹æŒ‡æ ‡æ”¶é›†

#### M1: Chat æ¥å…¥
3. **WebSocket èŠå¤©**
   - æ–‡ä»¶: `websocket/chat.py`
   - å®æ—¶ WebSocket è¿æ¥
   - æµå¼æ¶ˆæ¯è¾“å‡º
   - è¿æ¥ç®¡ç†å™¨

4. **ä¼šè¯ç®¡ç†**
   - æ–‡ä»¶: `api/sessions.py`
   - ä¼šè¯ CRUD æ“ä½œ
   - æ¶ˆæ¯å†å²è®°å½•
   - é»˜è®¤ main ä¼šè¯

#### M2: Observability
5. **ä»»åŠ¡æŸ¥è¯¢ API**
   - æ–‡ä»¶: `api/tasks.py`
   - ä»»åŠ¡åˆ—è¡¨æŸ¥è¯¢
   - ä»»åŠ¡è¯¦æƒ…æŸ¥è¯¢
   - è¿‡æ»¤å’Œåˆ†é¡µ

6. **äº‹ä»¶æµ API**
   - æ–‡ä»¶: `api/events.py`
   - äº‹ä»¶æŸ¥è¯¢
   - æ—¶é—´èŒƒå›´è¿‡æ»¤
   - å†…å­˜äº‹ä»¶å­˜å‚¨

7. **æ—¥å¿—æŸ¥è¯¢ API**
   - æ–‡ä»¶: `api/logs.py`
   - ç»“æ„åŒ–æ—¥å¿—æŸ¥è¯¢
   - å¤šç»´åº¦è¿‡æ»¤
   - æ—¥å¿—çº§åˆ«ç­›é€‰

#### M3: Skills/Memory æ¥å…¥
8. **Skills API**
   - æ–‡ä»¶: `api/skills.py`
   - Skills åˆ—è¡¨æŸ¥è¯¢
   - Skill è¯¦æƒ…æŸ¥è¯¢
   - Schema å±•ç¤º

9. **Memory API**
   - æ–‡ä»¶: `api/memory.py`
   - å†…å­˜æœç´¢
   - å†…å­˜å†™å…¥
   - å‘½åç©ºé—´ç®¡ç†

10. **é…ç½® API**
    - æ–‡ä»¶: `api/config.py`
    - é…ç½®æŸ¥çœ‹ (åªè¯»)
    - ç¯å¢ƒå˜é‡å±•ç¤º
    - ç‰ˆæœ¬ä¿¡æ¯

#### å‰ç«¯ç•Œé¢
11. **ä¸»ç•Œé¢æ¨¡æ¿**
    - æ–‡ä»¶: `templates/index.html`
    - å·¦ä¾§å¯¼èˆªæ 
    - é¡¶éƒ¨æ§åˆ¶æ 
    - è§†å›¾å®¹å™¨

12. **å¥åº·æ£€æŸ¥é¡µ**
    - æ–‡ä»¶: `templates/health.html`
    - ç³»ç»ŸçŠ¶æ€å±•ç¤º
    - API ç«¯ç‚¹åˆ—è¡¨

13. **CSS æ ·å¼**
    - æ–‡ä»¶: `static/css/main.css`
    - Tailwind CSS é›†æˆ
    - è‡ªå®šä¹‰ç»„ä»¶æ ·å¼
    - æ¶ˆæ¯æ°”æ³¡æ ·å¼

14. **JavaScript é€»è¾‘**
    - æ–‡ä»¶: `static/js/main.js`
    - è§†å›¾è·¯ç”±
    - WebSocket ç®¡ç†
    - å®æ—¶å¥åº·ç›‘æ§
    - æ¶ˆæ¯æ¸²æŸ“

#### CLI å‘½ä»¤
15. **Web å‘½ä»¤**
    - æ–‡ä»¶: `cli/web.py`
    - `agentos web` å¯åŠ¨å‘½ä»¤
    - ä¸»æœºå’Œç«¯å£é…ç½®
    - å¼€å‘æ¨¡å¼æ”¯æŒ
    - æ—¥å¿—çº§åˆ«æ§åˆ¶

16. **WebUI æ§åˆ¶å‘½ä»¤**
    - æ–‡ä»¶: `cli/webui_control.py`
    - `agentos webui start` - åå°å¯åŠ¨
    - `agentos webui stop` - åœæ­¢æœåŠ¡
    - `agentos webui restart` - é‡å¯æœåŠ¡
    - `agentos webui status` - æŸ¥çœ‹çŠ¶æ€
    - `agentos webui config` - é…ç½®ç®¡ç†

#### åå°æœåŠ¡ç®¡ç†
17. **Daemon ç®¡ç†å™¨**
    - æ–‡ä»¶: `webui/daemon.py`
    - åå°è¿›ç¨‹ç®¡ç†
    - PID æ–‡ä»¶è¿½è¸ª
    - å¥åº·æ£€æŸ¥
    - ä¼˜é›…åœæ­¢

#### è‡ªåŠ¨å¯åŠ¨é›†æˆ
18. **CLI è‡ªåŠ¨å¯åŠ¨**
    - æ–‡ä»¶: `cli/main.py`
    - ä»»ä½•å‘½ä»¤è‡ªåŠ¨è§¦å‘ WebUI
    - æ™ºèƒ½æ£€æµ‹é¿å…é‡å¤å¯åŠ¨
    - é…ç½®æ§åˆ¶å¯ç”¨/ç¦ç”¨

### â³ å¾…å®ç°åŠŸèƒ½

1. **æ•°æ®æŒä¹…åŒ–** (ä¼˜å…ˆçº§: P1)
   - å°†ä¼šè¯å’Œæ¶ˆæ¯æŒä¹…åŒ–åˆ°æ•°æ®åº“
   - æ›¿ä»£å½“å‰çš„å†…å­˜å­˜å‚¨

2. **Chat Engine é›†æˆ** (ä¼˜å…ˆçº§: P1)
   - é›†æˆ `agentos.core.chat`
   - æ›¿ä»£å½“å‰çš„ Echo å ä½

3. **å®æ—¶äº‹ä»¶æ¨é€** (ä¼˜å…ˆçº§: P2)
   - WebSocket äº‹ä»¶æµæ¨é€
   - å®æ—¶ä»»åŠ¡çŠ¶æ€æ›´æ–°

4. **èº«ä»½è®¤è¯** (ä¼˜å…ˆçº§: P2)
   - åŸºç¡€è®¤è¯æ”¯æŒ
   - Token è®¤è¯

5. **ä»»åŠ¡æ§åˆ¶** (ä¼˜å…ˆçº§: P2)
   - æš‚åœ/æ¢å¤ä»»åŠ¡
   - å–æ¶ˆä»»åŠ¡æ‰§è¡Œ

6. **Open Plan å¯è§†åŒ–** (ä¼˜å…ˆçº§: P3)
   - æ‰§è¡Œå›¾å¯è§†åŒ–
   - èŠ‚ç‚¹ä¾èµ–å±•ç¤º

---

## äºŒåä¸‰ã€æ¶æ„æ–‡æ¡£ç³»ç»Ÿ âœ¨ v0.3.1 æ–°å¢

**æ–‡ä»¶ä½ç½®**: `docs/architecture/`

### âœ… å·²å®ç°åŠŸèƒ½

1. **æ¶æ„å†³ç­–è®°å½• (ADR) ç´¢å¼•**
   - æ–‡ä»¶: `README.md` â†’ `docs/architecture/README.md`
   - åŠŸèƒ½ç‚¹:
     - ADR ç´¢å¼•è¡¨
     - æ¶æ„å›¾ç¤ºä¾‹
     - è®¾è®¡åŸåˆ™è¯´æ˜
     - ç‰ˆæœ¬å†å²
     - è´¡çŒ®æŒ‡å—

2. **éªŒè¯å±‚æ¶æ„æ–‡æ¡£ (AD-001)**
   - æ–‡ä»¶: `VALIDATION_LAYERS.md` â†’ `docs/architecture/VALIDATION_LAYERS.md`
   - åŠŸèƒ½ç‚¹:
     - ä¸‰å±‚éªŒè¯æ¶æ„å¥‘çº¦
     - Layer 1: Schema Validation (ç»“æ„éªŒè¯)
     - Layer 2: Business Rules (è¯­ä¹‰éªŒè¯)
     - Layer 3: Dry Executor RED LINE (å®‰å…¨éªŒè¯)
     - æ¶æ„å†³ç­– AD-001: éªŒè¯å±‚è´£ä»»åˆ†ç¦»
     - å±‚çº§ä¸å¯¹é½çš„è®¾è®¡ç†ç”±
     - é”™è¯¯æ¶ˆæ¯æ ‡è®°è§„èŒƒ

### â³ å¾…å®ç°åŠŸèƒ½
- æš‚æ— å¾…å®ç°é¡¹

---

## äºŒåå››ã€æ¶æ„çº¦æŸ (RED LINES)

### âœ… å·²å®ç°çš„ RED LINES

#### 1. **Pause Gate RED LINE (V1 é“å¾‹)**
- æ–‡ä»¶: `agentos/core/gates/pause_gate.py`
- çº¦æŸ: ä»…å…è®¸åœ¨ `open_plan` æ£€æŸ¥ç‚¹æš‚åœ
- å®ç°çŠ¶æ€: âœ… å®Œæ•´å®ç°

#### 2. **Mode Gate RED LINE**
- æ–‡ä»¶: `agentos/core/mode/mode.py`
- çº¦æŸ: ä»… `implementation` æ¨¡å¼å…è®¸ diff/commit
- å®ç°çŠ¶æ€: âœ… å®Œæ•´å®ç°

#### 3. **Coordinator RED LINE (v0.9.2)**
- æ–‡ä»¶: `agentos/core/coordinator/engine.py`
- çº¦æŸ: ä¸æ‰§è¡Œä»»ä½•å‘½ä»¤ï¼Œä»…ç”Ÿæˆè®¡åˆ’
- å®ç°çŠ¶æ€: âœ… å®Œæ•´å®ç°

#### 4. **Evaluator RED LINE (RL-E1)**
- æ–‡ä»¶: `agentos/core/evaluator/engine.py`
- çº¦æŸ: ç¦æ­¢æ‰§è¡Œ
- å®ç°çŠ¶æ€: âœ… å®Œæ•´å®ç°

#### 5. **Dry Executor RED LINES (DE1-DE6)**
- æ–‡ä»¶: `agentos/core/executor_dry/open_plan_verifier.py`
- çº¦æŸ:
  - DE1: æ— æ‰§è¡Œ (subprocess, exec ç¦æ­¢)
  - DE2: æ— æ–‡ä»¶ç³»ç»Ÿå†™å…¥
  - DE3: æ— è·¯å¾„ä¼ªé€ 
  - DE4: æ‰€æœ‰èŠ‚ç‚¹å¿…é¡»æœ‰ evidence_refs
  - DE5: é«˜/å…³é”®é£é™©å¿…é¡» requires_review
  - DE6: Output å¿…é¡»å¯å†»ç»“
- å®ç°çŠ¶æ€: âœ… å®Œæ•´å®ç°

---

## æ€»ç»“ç»Ÿè®¡

### ä»£ç è§„æ¨¡

- **æ ¸å¿ƒä»£ç **: 34,831 è¡Œ
- **é¡¶å±‚åŒ…æ•°**: 46 ä¸ª
- **Python æ–‡ä»¶**: 250+ ä¸ª
- **æµ‹è¯•æ–‡ä»¶**: 50+ ä¸ª

### åŠŸèƒ½å®ç°ç»Ÿè®¡

| æ¨¡å—åˆ†ç±» | å·²å®ç° âœ… | éƒ¨åˆ†å®ç° ğŸ”§ | å¾…å®ç° â³ |
|---------|----------|------------|----------|
| æ ¸å¿ƒæ¶æ„ç³»ç»Ÿ | 6 | 0 | 0 |
| WebUI ç³»ç»Ÿ | 18 | 0 | 6 |
| ä»»åŠ¡ç®¡ç†ç³»ç»Ÿ | 5 | 0 | 0 |
| æ‰§è¡Œå¼•æ“ | 7 | 0 | 0 |
| å¹²è¿è¡Œæ‰§è¡Œå™¨ | 7 | 0 | 0 |
| åè°ƒå™¨ | 6 | 0 | 0 |
| è¯„ä¼°å™¨ | 7 | 0 | 0 |
| æ„å›¾æ„å»º | 5 | 0 | 0 |
| çŸ¥è¯†åº“ç³»ç»Ÿ | 8 | 0 | 2 |
| å†…å­˜ç³»ç»Ÿ | 7 | 0 | 0 |
| å®‰å…¨é—¨æ§ | 5 | 0 | 0 |
| èŠå¤©ç³»ç»Ÿ | 6 | 0 | 0 |
| å†…å®¹ç®¡ç† | 5 | 0 | 0 |
| æ¨¡å‹ç®¡ç† | 2 | 0 | 0 |
| åˆ†å¸ƒå¼é” | 4 | 0 | 0 |
| åŸºç¡€è®¾æ–½ | 4 | 0 | 0 |
| Schema ç³»ç»Ÿ | 10 | 0 | 0 |
| CLI ç³»ç»Ÿ | 25 | 0 | 0 |
| æ•°æ®å­˜å‚¨ | 4 | 0 | 0 |
| ç¼–æ’ç³»ç»Ÿ | 3 | 0 | 0 |
| å·¥å…·æ‰©å±• | 6 | 0 | 0 |
| é¡¹ç›®é€‚é…å™¨ | 3 | 0 | 0 |
| å›½é™…åŒ– | 2 | 0 | 0 |
| MemoryOS | 4 | 0 | 0 |
| æµ‹è¯•ç³»ç»Ÿ | 8 | 0 | 0 |
| å…¶ä»–æ¨¡å— | 16 | 0 | 0 |
| è¾…åŠ©å·¥å…· | 6 | 0 | 0 |
| æ¶æ„æ–‡æ¡£ç³»ç»Ÿ | 2 | 0 | 0 |
| **æ€»è®¡** | **181** | **0** | **8** |

### å¾…å®ç°åŠŸèƒ½ä¼˜å…ˆçº§åˆ†å¸ƒ (v0.3.1 æ¸…ç†å)

| ä¼˜å…ˆçº§ | æ•°é‡ | å æ¯” | åˆ†å¸ƒ |
|--------|------|------|------|
| P1 (é«˜) | 2 | 25.0% | WebUI: æ•°æ®æŒä¹…åŒ–, Chat Engine é›†æˆ |
| P2 (ä¸­) | 2 | 25.0% | WebUI: å®æ—¶äº‹ä»¶æ¨é€, èº«ä»½è®¤è¯ |
| P3 (ä½) | 4 | 50.0% | WebUI + KB: ä»»åŠ¡æ§åˆ¶, Open Plan å¯è§†åŒ–, OpenAI åµŒå…¥, é«˜çº§æœç´¢ |
| **æ€»è®¡** | **8** | **100%** | |

### å®ç°å®Œæˆåº¦ (v0.3.1)

- **å®Œæ•´å®ç°ç‡**: 95.8% (181/189) â¬†ï¸ +6.9%
- **å¾…å®Œå–„ç‡**: 0.0% (0/189) â¬‡ï¸ -0.6%
- **å¾…å®ç°ç‡**: 4.2% (8/189) â¬‡ï¸ -6.3%

**v0.3.1 å˜åŒ–**:
- âœ… å®Œæˆ 12 ä¸ªæ ¸å¿ƒ TODO (Stabilization Sprint)
- âœ… æ–°å¢ 2 ä¸ªæ¶æ„æ–‡æ¡£æ¨¡å—
- âœ… æ–°å¢ 3 ä¸ªæ ¸å¿ƒåŠŸèƒ½ (SchemaValidatorService, DryExecutorValidator, VALIDATION_LAYERS)
- ğŸ¯ å‰©ä½™ 8 ä¸ª TODO å…¨éƒ¨å±äº WebUI ç³»ç»Ÿ (éæ ¸å¿ƒé˜»å¡é¡¹)

---

## é™„å½•ï¼šå…³é”®æŠ€æœ¯ç‰¹æ€§

### 1. æ¶æ„äº®ç‚¹

1. **Task-Driven Architecture** - ä»¥ä»»åŠ¡ä¸ºä¸­å¿ƒçš„çŠ¶æ€ç®¡ç†
2. **ä¸‰å±‚æ‰§è¡Œæ¨¡å‹** - Run Mode / Execution Mode / Model Policy åˆ†ç¦»
3. **RED LINE è®¾è®¡** - ç¡¬ç¼–ç æ¶æ„çº¦æŸ (5 æ¡é“å¾‹)
4. **å¼ºå¯ä¸­æ–­æ€§** - Pause Checkpoint æœºåˆ¶
5. **å®Œæ•´å¯è¿½è¸ªæ€§** - Lineage + Audit å…¨è®°å½•
6. **å£°æ˜å¼è®¡åˆ’** - Open Plan å£°æ˜å¼æ‰§è¡Œ
7. **åˆ†å¸ƒå¼é”æ”¯æŒ** - å¹¶å‘å®‰å…¨ä¿è¯
8. **åŸç”Ÿåå°æ‰§è¡Œ** - å¼‚æ­¥ä»»åŠ¡æ”¯æŒ

### 2. æ ¸å¿ƒä¾èµ–

- `click` - CLI æ¡†æ¶
- `rich` - å¯Œæ–‡æœ¬è¾“å‡º
- `anthropic` - Claude API
- `openai` - OpenAI API
- `docker` - å®¹å™¨ç®¡ç†
- `gitpython` - Git æ“ä½œ
- `jsonschema` - Schema éªŒè¯
- `networkx` - å›¾ç®—æ³•

### 3. æ•°æ®åº“è®¾è®¡

- **å¼•æ“**: SQLite 3
- **æ¨¡å¼ç‰ˆæœ¬**: v0.6
- **ä¸»è¦è¡¨**: 11 å¼ è¡¨
- **ç´¢å¼•**: FTS5 å…¨æ–‡ç´¢å¼•
- **è¿ç§»**: è¯­ä¹‰ç‰ˆæœ¬åŒ–è‡ªåŠ¨è¿ç§»

---

**æ–‡æ¡£ç”Ÿæˆæ—¶é—´**: 2026-01-27
**ä¸‹æ¬¡æ›´æ–°å»ºè®®**: æ¯ä¸ª Sprint ç»“æŸåæ›´æ–°
