# FloatingPet 3D æ—‹è½¬æ•ˆæœ

**ç‰ˆæœ¬**: v0.3.2.6
**æ—¥æœŸ**: 2026-01-29
**åŠŸèƒ½**: é¼ æ ‡è·Ÿéš 3D æ—‹è½¬æ•ˆæœ

---

## ğŸ¯ æ•ˆæœè¯´æ˜

### 2D æ—‹è½¬ vs 3D æ—‹è½¬

**ä¹‹å‰ï¼ˆv0.3.2.4 - 2D æ—‹è½¬ï¼‰**:
- å°ç‹—åœ¨å¹³é¢ä¸Šæ—‹è½¬æœå‘é¼ æ ‡æ–¹å‘
- ä½¿ç”¨ `rotate(angle)` è¿›è¡Œ Z è½´æ—‹è½¬
- æ•ˆæœç±»ä¼¼æŒ‡å—é’ˆ

**ç°åœ¨ï¼ˆv0.3.2.6 - 3D æ—‹è½¬ï¼‰**:
- å°ç‹—åƒç«‹ä½“ç‰©ä½“ä¸€æ ·è¿›è¡Œ 3D å€¾æ–œ
- ä½¿ç”¨ `rotateX()` å’Œ `rotateY()` è¿›è¡Œ 3D æ—‹è½¬
- æ•ˆæœç±»ä¼¼å¡ç‰‡è·Ÿéšé¼ æ ‡å€¾æ–œ

---

## ğŸ¨ äº¤äº’è¡Œä¸º

### é¼ æ ‡ä½ç½® â†’ æ—‹è½¬æ•ˆæœ

| é¼ æ ‡ä½ç½® | æ—‹è½¬æ•ˆæœ | è¯´æ˜ |
|---------|---------|------|
| **ä¸­å¿ƒ** | æ— æ—‹è½¬ | rotateX(0Â°) rotateY(0Â°) |
| **å·¦ä¸Š** | å‘å·¦ä¸Šå€¾æ–œ | rotateX(+15Â°) rotateY(-15Â°) |
| **å³ä¸Š** | å‘å³ä¸Šå€¾æ–œ | rotateX(+15Â°) rotateY(+15Â°) |
| **å·¦ä¸‹** | å‘å·¦ä¸‹å€¾æ–œ | rotateX(-15Â°) rotateY(-15Â°) |
| **å³ä¸‹** | å‘å³ä¸‹å€¾æ–œ | rotateX(-15Â°) rotateY(+15Â°) |

### å‚æ•°è¯´æ˜

- **æœ€å¤§æ—‹è½¬è§’åº¦**: 15Â°ï¼ˆå¯è°ƒæ•´ï¼‰
- **é€è§†è·ç¦»**: 1000pxï¼ˆæ§åˆ¶ 3D æ·±åº¦æ„Ÿï¼‰
- **è¿‡æ¸¡æ—¶é—´**: 0.15s ease-outï¼ˆå¹³æ»‘è¿‡æ¸¡ï¼‰
- **åŠ¨ç”»åŠ é€Ÿ**: 1.5xï¼ˆå¢å¼ºäº’åŠ¨æ„Ÿï¼‰

---

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. JavaScript è®¡ç®—

```javascript
_bindPetHover() {
    wrap.addEventListener('mousemove', (e) => {
        // è·å–å®¹å™¨è¾¹ç•Œ
        const rect = this._lottieEl.getBoundingClientRect();

        // è®¡ç®—é¼ æ ‡ç›¸å¯¹ä½ç½®ï¼ˆ0 åˆ° 1ï¼‰
        const x = (e.clientX - rect.left) / rect.width;
        const y = (e.clientY - rect.top) / rect.height;

        // è½¬æ¢ä¸º -1 åˆ° 1ï¼ˆä¸­å¿ƒä¸º 0ï¼‰
        const centerX = (x - 0.5) * 2;  // å·¦ -1, ä¸­ 0, å³ +1
        const centerY = (y - 0.5) * 2;  // ä¸Š -1, ä¸­ 0, ä¸‹ +1

        // è®¡ç®—æ—‹è½¬è§’åº¦ï¼ˆæœ€å¤§ 15Â°ï¼‰
        const maxRotation = 15;
        const rotateY = centerX * maxRotation;  // å·¦å³æ—‹è½¬
        const rotateX = -centerY * maxRotation; // ä¸Šä¸‹æ—‹è½¬ï¼ˆè´Ÿå·ä½¿æ–¹å‘è‡ªç„¶ï¼‰

        // åº”ç”¨ 3D å˜æ¢
        this._lottieEl.style.transform =
            `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;

        // åŠ é€ŸåŠ¨ç”»
        this._lottie.setSpeed(1.5);
    });

    // é¼ æ ‡ç¦»å¼€æ¢å¤
    wrap.addEventListener('mouseleave', () => {
        this._lottieEl.style.transform =
            'perspective(1000px) rotateX(0deg) rotateY(0deg)';
        this._lottie.setSpeed(1.0);
    });
}
```

### 2. CSS æ ·å¼

```css
/* çˆ¶å®¹å™¨ - è®¾ç½®é€è§† */
.fp-pet {
    perspective: 1000px;
    transform-style: preserve-3d;
}

/* Lottie å…ƒç´  - åº”ç”¨ 3D å˜æ¢ */
.fp-lottie {
    transition: transform 0.15s ease-out;
    transform-origin: center center;
    transform-style: preserve-3d;
}
```

---

## ğŸ“ æ•°å­¦åŸç†

### åæ ‡ç³»è½¬æ¢

```
é¼ æ ‡ä½ç½® (clientX, clientY)
    â†“
å®¹å™¨å†…ç›¸å¯¹ä½ç½® (x, y)  [0, 1]
    â†“
ä¸­å¿ƒå½’ä¸€åŒ– (centerX, centerY)  [-1, 1]
    â†“
æ—‹è½¬è§’åº¦ (rotateX, rotateY)  [-15Â°, 15Â°]
```

### æ—‹è½¬æ–¹å‘

```
rotateX (ä¸Šä¸‹å€¾æ–œ):
  - é¼ æ ‡åœ¨ä¸Šæ–¹ (centerY < 0) â†’ rotateX > 0 â†’ å‘ä¸Šå€¾æ–œ
  - é¼ æ ‡åœ¨ä¸‹æ–¹ (centerY > 0) â†’ rotateX < 0 â†’ å‘ä¸‹å€¾æ–œ

rotateY (å·¦å³å€¾æ–œ):
  - é¼ æ ‡åœ¨å·¦ä¾§ (centerX < 0) â†’ rotateY < 0 â†’ å‘å·¦è½¬
  - é¼ æ ‡åœ¨å³ä¾§ (centerX > 0) â†’ rotateY > 0 â†’ å‘å³è½¬
```

### ä¸ºä»€ä¹ˆ rotateX ç”¨è´Ÿå·ï¼Ÿ

```javascript
const rotateX = -centerY * maxRotation;
```

- é¼ æ ‡åœ¨ä¸Šæ–¹æ—¶ `centerY < 0`ï¼Œæˆ‘ä»¬å¸Œæœ›ç‰©ä½“å‘ä¸Šå€¾æ–œï¼ˆrotateX > 0ï¼‰
- å› æ­¤éœ€è¦å–è´Ÿå·ï¼š`rotateX = -centerY` â†’ æ­£å€¼
- è¿™æ ·å€¾æ–œæ–¹å‘æ›´è‡ªç„¶ï¼Œç¬¦åˆç›´è§‰

---

## ğŸ¨ è§†è§‰æ•ˆæœ

### é€è§†åŸç†

```
perspective: 1000px

   è§‚å¯Ÿè€…
      â†“
   1000px è·ç¦»
      â†“
   [å°ç‹—åŠ¨ç”»]  â† åœ¨ 3D ç©ºé—´ä¸­æ—‹è½¬
```

- **perspective è¶Šå°**: 3D æ•ˆæœè¶Šå¤¸å¼ ï¼ˆå¦‚ 500pxï¼‰
- **perspective è¶Šå¤§**: 3D æ•ˆæœè¶Šå¹³ç¼“ï¼ˆå¦‚ 2000pxï¼‰
- **1000px**: å¹³è¡¡å€¼ï¼Œæ—¢æœ‰ç«‹ä½“æ„Ÿåˆä¸è¿‡äºå¤¸å¼ 

### transform-style: preserve-3d

- ç¡®ä¿å­å…ƒç´ åœ¨ 3D ç©ºé—´ä¸­æ¸²æŸ“
- å¦‚æœä¸è®¾ç½®ï¼Œ3D æ•ˆæœä¼šè¢«"å‹å¹³"

---

## ğŸš€ æµ‹è¯•éªŒè¯

### æµ‹è¯•æ­¥éª¤

1. **å¯åŠ¨ WebUI**:
   ```bash
   python -m agentos.webui.app
   http://localhost:8080
   ```

2. **æŒ‰ Ctrl+Shift+R æ¸…é™¤ç¼“å­˜**

3. **æ‰“å¼€é¢æ¿**:
   - ç‚¹å‡»å³ä¸‹è§’ FAB æŒ‰é’®
   - é¢æ¿æ‰“å¼€ï¼Œæ˜¾ç¤ºå°ç‹—åŠ¨ç”»

4. **æµ‹è¯• 3D æ—‹è½¬**:
   - å°†é¼ æ ‡ç§»åŠ¨åˆ°å® ç‰©åŒºåŸŸ
   - å·¦å³ç§»åŠ¨é¼ æ ‡ â†’ å°ç‹—å·¦å³å€¾æ–œ
   - ä¸Šä¸‹ç§»åŠ¨é¼ æ ‡ â†’ å°ç‹—ä¸Šä¸‹å€¾æ–œ
   - é¼ æ ‡åœ¨ä¸­å¿ƒ â†’ å°ç‹—ä¸æ—‹è½¬
   - é¼ æ ‡ç¦»å¼€ â†’ å°ç‹—æ¢å¤æ­£é¢

### éªŒè¯æ¸…å•

- [ ] é¼ æ ‡åœ¨å·¦ä¾§ï¼Œå°ç‹—å‘å·¦å€¾æ–œ
- [ ] é¼ æ ‡åœ¨å³ä¾§ï¼Œå°ç‹—å‘å³å€¾æ–œ
- [ ] é¼ æ ‡åœ¨ä¸Šæ–¹ï¼Œå°ç‹—å‘ä¸Šå€¾æ–œ
- [ ] é¼ æ ‡åœ¨ä¸‹æ–¹ï¼Œå°ç‹—å‘ä¸‹å€¾æ–œ
- [ ] é¼ æ ‡åœ¨ä¸­å¿ƒï¼Œå°ç‹—æ­£é¢ï¼ˆä¸æ—‹è½¬ï¼‰
- [ ] é¼ æ ‡ç¦»å¼€ï¼Œå°ç‹—å¹³æ»‘æ¢å¤æ­£é¢
- [ ] æ—‹è½¬è¿‡æ¸¡æµç•…ï¼ˆ0.15sï¼‰
- [ ] åŒæ—¶åŠ¨ç”»åŠ é€Ÿï¼ˆ1.5xï¼‰

---

## ğŸ›ï¸ è‡ªå®šä¹‰é…ç½®

### è°ƒæ•´æœ€å¤§æ—‹è½¬è§’åº¦

```javascript
// åœ¨ FloatingPet.js çš„ _bindPetHover ä¸­
const maxRotation = 20;  // æ”¹ä¸º 20Â°ï¼ˆæ›´å¤¸å¼ ï¼‰
const maxRotation = 10;  // æ”¹ä¸º 10Â°ï¼ˆæ›´æ¸©å’Œï¼‰
```

### è°ƒæ•´é€è§†è·ç¦»

```css
/* åœ¨ floating-pet.css ä¸­ */
.fp-pet {
    perspective: 800px;  /* æ›´å¤¸å¼ çš„ 3D æ•ˆæœ */
}

/* æˆ–è€…åœ¨ JavaScript ä¸­ */
this._lottieEl.style.transform =
    `perspective(800px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
```

### è°ƒæ•´è¿‡æ¸¡é€Ÿåº¦

```css
/* åœ¨ floating-pet.css ä¸­ */
.fp-lottie {
    transition: transform 0.2s ease-out;  /* æ›´æ…¢ */
    transition: transform 0.1s ease-out;  /* æ›´å¿« */
}
```

### ç¦ç”¨ 3D æ—‹è½¬

å¦‚æœæƒ³æ¢å¤ç®€å•æ•ˆæœï¼Œæ³¨é‡Šæ‰ mousemove äº‹ä»¶ï¼š

```javascript
// wrap.addEventListener('mousemove', (e) => {
//     // ... 3D æ—‹è½¬ä»£ç 
// });
```

---

## ğŸ“Š æ€§èƒ½è€ƒè™‘

### GPU åŠ é€Ÿ

- `perspective` å’Œ `rotateX/rotateY` è‡ªåŠ¨å¯ç”¨ GPU åŠ é€Ÿ
- ä½¿ç”¨ `transform` è€Œé `left/top`ï¼Œé¿å…é‡æ’
- `transform-style: preserve-3d` ç¡®ä¿ç¡¬ä»¶åŠ é€Ÿ

### æµç•…åº¦

- ä½¿ç”¨ `transition` è€Œé JavaScript åŠ¨ç”»
- `ease-out` æä¾›è‡ªç„¶å‡é€Ÿæ•ˆæœ
- 0.15s è¿‡æ¸¡æ—¶é—´å¹³è¡¡æµç•…åº¦å’Œå“åº”æ€§

---

## ğŸ‰ å®Œæˆæ•ˆæœ

**v0.3.2.6 3D æ—‹è½¬æ•ˆæœ**:

âœ… **ç«‹ä½“æ„Ÿå¼ºçƒˆ** - å°ç‹—åƒçœŸå® 3D ç‰©ä½“ä¸€æ ·å€¾æ–œ
âœ… **è·Ÿéšè‡ªç„¶** - é¼ æ ‡ç§»åŠ¨æ–¹å‘ä¸å°ç‹—å€¾æ–œæ–¹å‘ä¸€è‡´
âœ… **è¿‡æ¸¡æµç•…** - 0.15s å¹³æ»‘è¿‡æ¸¡ï¼Œä¸å¡é¡¿
âœ… **äº’åŠ¨å¢å¼º** - åŒæ—¶åŠ é€ŸåŠ¨ç”»ï¼Œå¢å¼ºäº’åŠ¨æ„Ÿ
âœ… **GPU åŠ é€Ÿ** - ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿï¼Œæ€§èƒ½ä¼˜ç§€

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- **FloatingPet ä¸»æ–‡æ¡£**: `FLOATING_PET_README.md`
- **v0.3.2.4 åŠŸèƒ½å¢å¼º**: `FLOATING_PET_V4_ENHANCEMENTS.md`
- **ä½ç½®ä¿®å¤**: `FLOATING_PET_POSITION_FIX.md`
- **Lottie é›†æˆ**: `FLOATING_PET_LOTTIE_INTEGRATION.md`

---

## ğŸ’¡ Pro Tips

1. **è°ƒæ•´é€è§†è·ç¦»**: å¦‚æœè§‰å¾— 3D æ•ˆæœå¤ªå¤¸å¼ ï¼Œå¢å¤§ perspective å€¼ï¼ˆå¦‚ 1500pxï¼‰
2. **è°ƒæ•´æœ€å¤§è§’åº¦**: å¦‚æœè§‰å¾—å€¾æ–œå¤ªå¤šï¼Œå‡å° maxRotationï¼ˆå¦‚ 10Â°ï¼‰
3. **æµ‹è¯•ç§»åŠ¨ç«¯**: ç§»åŠ¨ç«¯æ²¡æœ‰ hoverï¼Œ3D æ•ˆæœä¸ä¼šè§¦å‘ï¼ˆæ­£å¸¸ï¼‰
4. **æµè§ˆå™¨å…¼å®¹æ€§**: ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒ 3D transform

---

**ç«‹å³ä½“éªŒ 3D æ—‹è½¬æ•ˆæœï¼** ğŸ®âœ¨

---

**ç‰ˆæœ¬**: v0.3.2.6
**æ—¥æœŸ**: 2026-01-29
**ä½œè€…**: Claude Sonnet 4.5
