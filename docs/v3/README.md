# AgentOS v3 æ–‡æ¡£ç´¢å¼•

## æ¦‚è¿°

AgentOS v3 å¼•å…¥äº† **Shadow Evaluation + Controlled Adaptation** ç³»ç»Ÿï¼Œå®ç°äº†åˆ†ç±»å™¨çš„å®‰å…¨è¿›åŒ–æœºåˆ¶ã€‚

**æ ¸å¿ƒç†å¿µ**: ç³»ç»Ÿåœ¨"ä¸æ”¹å˜è¡Œä¸º"çš„å‰æä¸‹ï¼Œå­¦ä¼šæ¯”è¾ƒ"å¦‚æœå½“æ—¶è¿™æ ·åˆ¤æ–­ä¼šä¸ä¼šæ›´å¥½"ã€‚

---

## ğŸ“– æ–‡æ¡£å¯¼èˆª

### ğŸ¯ å¿«é€Ÿå…¥é—¨

1. **[v3 å®æ–½å®ŒæˆæŠ¥å‘Š](./V3_IMPLEMENTATION_COMPLETE.md)** â­ å¿…è¯»
   - å®Œæ•´çš„ç³»ç»Ÿæ¦‚è¿°
   - åˆ†é˜¶æ®µäº¤ä»˜æˆæœ
   - ä½¿ç”¨æŒ‡å—å’Œæœ€ä½³å®è·µ
   - å·¥ä½œæµç¨‹ç¤ºä¾‹

### ğŸ—ï¸ æŠ€æœ¯æ¶æ„

2. **[Shadow Classifier Registry](./SHADOW_CLASSIFIER_REGISTRY.md)**
   - Shadow åˆ†ç±»å™¨æ³¨å†Œå’Œç®¡ç†
   - å¤šç‰ˆæœ¬å¹¶è¡Œè¿è¡Œæœºåˆ¶
   - é…ç½®æ–‡ä»¶æ ¼å¼

3. **[Shadow Classifier Registry å¿«é€Ÿå‚è€ƒ](./SHADOW_CLASSIFIER_REGISTRY_QUICK_REF.md)**
   - API å¿«é€ŸæŸ¥è¯¢
   - å¸¸è§ä½¿ç”¨åœºæ™¯
   - æ•…éšœæ’é™¤

4. **[Audit Log v3 Schema](./AUDIT_LOG_V3_SCHEMA.md)**
   - æ‰©å±•çš„å®¡è®¡æ—¥å¿—ç»“æ„
   - å¤šå†³ç­–è®°å½•æœºåˆ¶
   - æŸ¥è¯¢æ¥å£

### ğŸ“Š è¯„ä¼°ç³»ç»Ÿ

5. **Shadow Score Calculator** (ä½äºæ ¹ç›®å½•)
   - Reality Alignment Score è®¡ç®—é€»è¾‘
   - ç”¨æˆ·è¡Œä¸ºä¿¡å·æƒé‡
   - è¯„åˆ†å¯è§£é‡Šæ€§

6. **Decision Comparator** (ä½äºæ ¹ç›®å½•)
   - Active vs Shadow å¯¹æ¯”æŒ‡æ ‡
   - æ”¹è¿›ç‡è®¡ç®—
   - èšåˆåˆ†æ

### ğŸ¤– BrainOS é›†æˆ

7. **Improvement Proposal Generation** (ä½äºæ ¹ç›®å½•)
   - è‡ªåŠ¨ææ¡ˆç”Ÿæˆé€»è¾‘
   - é£é™©è¯„ä¼°ç®—æ³•
   - å®šæ—¶ä»»åŠ¡é…ç½®

8. **Review Queue API** (ä½äºæ ¹ç›®å½•)
   - äººå·¥å®¡æŸ¥æ¥å£
   - æ‰¹å‡†/æ‹’ç»æµç¨‹
   - å®¡è®¡è¿½è¸ª

### ğŸ”§ å·¥å…·é“¾

9. **Classifier Version Manager** (ä½äºæ ¹ç›®å½•)
   - ç‰ˆæœ¬å·ç®¡ç†
   - å˜æ›´æ—¥å¿—
   - å›æ»šæœºåˆ¶

10. **Classifier Migration Tool** (ä½äºæ ¹ç›®å½•)
    - Shadow â†’ Active å®‰å…¨è¿ç§»
    - å‰ç½®æ¡ä»¶éªŒè¯
    - ä¸€é”®å›æ»š

---

## ğŸ—‚ï¸ éªŒæ”¶æŠ¥å‘Š

æ‰€æœ‰ä»»åŠ¡çš„è¯¦ç»†éªŒæ”¶æŠ¥å‘Šä½äºé¡¹ç›®æ ¹ç›®å½•ï¼š

- `DECISION_CANDIDATE_ACCEPTANCE_REPORT.md` - Task #1
- `SHADOW_CLASSIFIER_REGISTRY_ACCEPTANCE_REPORT.md` - Task #2
- `TASK_3_AUDIT_LOG_ACCEPTANCE_REPORT.md` - Task #3
- `SHADOW_SCORE_CALCULATOR_ACCEPTANCE_REPORT.md` - Task #4
- `TASK_5_DECISION_COMPARATOR_ACCEPTANCE_REPORT.md` - Task #5
- `DECISION_COMPARISON_VIEW_ACCEPTANCE_REPORT.md` - Task #6
- `TASK_7_IMPROVEMENT_PROPOSAL_ACCEPTANCE_REPORT.md` - Task #7
- `IMPROVEMENT_PROPOSAL_GENERATION_ACCEPTANCE_REPORT.md` - Task #8
- Review Queue API éªŒæ”¶æŠ¥å‘Š - Task #9
- Classifier Version Manager éªŒæ”¶æŠ¥å‘Š - Task #10
- Classifier Migration Tool éªŒæ”¶æŠ¥å‘Š - Task #11

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. æŸ¥çœ‹å½“å‰ Shadow çŠ¶æ€

```bash
# æŸ¥çœ‹æ‰€æœ‰ Shadow Classifiers
python3 -c "from agentos.core.chat.shadow_registry import get_shadow_registry; \
print(get_shadow_registry().get_active_shadows())"
```

### 2. æŸ¥çœ‹å†³ç­–å¯¹æ¯”

è®¿é—® WebUI:
```
http://localhost:8000/
```

å¯¼èˆªåˆ° "Decision Comparison" è§†å›¾ã€‚

### 3. ç”Ÿæˆæ”¹è¿›ææ¡ˆ

```bash
# æ‰‹åŠ¨è§¦å‘ï¼ˆDry Runï¼‰
python3 -m agentos.jobs.improvement_proposal_generation \
  --shadow=v2-shadow-a \
  --dry-run

# å®é™…ç”Ÿæˆ
python3 -m agentos.jobs.improvement_proposal_generation \
  --shadow=v2-shadow-a
```

### 4. å®¡æŸ¥ææ¡ˆ

```bash
# æŸ¥çœ‹å¾…å®¡æŸ¥ææ¡ˆ
curl http://localhost:8000/api/v3/review-queue

# æ‰¹å‡†ææ¡ˆ
curl -X POST http://localhost:8000/api/v3/review-queue/BP-001/approve
```

### 5. è¿ç§» Shadow

```bash
# éªŒè¯å‰ç½®æ¡ä»¶
agentos classifier migrate verify --shadow v2-shadow-a

# æ‰§è¡Œè¿ç§»
agentos classifier migrate to-active --shadow v2-shadow-a
```

---

## ğŸ“Š ç³»ç»Ÿæ¶æ„å›¾

```
User Question
    â†“
InfoNeedClassifier System (Active + Shadow)
    â†“
DecisionSet Storage (Audit Log v3)
    â†“
Reality Alignment Score (Shadow Evaluator)
    â†“
Decision Comparator (å¯¹æ¯”åˆ†æ)
    â†“
WebUI Dashboard (å¯è§†åŒ–)
    â†“
BrainOS Proposal Generator (è‡ªåŠ¨å»ºè®®)
    â†“
Review Queue API (äººå·¥å®¡æŸ¥)
    â†“
Version Manager (ç‰ˆæœ¬ç®¡ç†)
    â†“
Migration Tool (å®‰å…¨è¿ç§»)
```

---

## ğŸ¯ æ ¸å¿ƒåŸåˆ™ï¼ˆçº¢çº¿æœºåˆ¶ï¼‰

### âŒ æ˜ç¡®ç¦æ­¢

- BrainOS ä¸èƒ½ç›´æ¥ä¿®æ”¹ InfoNeedClassifier å†³ç­–
- Shadow ç»“æœæ°¸ä¸å½±å“å®æ—¶ç”¨æˆ·è¡Œä¸º
- ä¸ä½¿ç”¨"ç­”æ¡ˆæ­£ç¡®æ€§"ä½œä¸ºåé¦ˆä¿¡å·
- æœªç»äººç±»ç¡®è®¤çš„è§„åˆ™ä¸èƒ½è‡ªåŠ¨ä¸Šçº¿

### âœ… å”¯ä¸€å…è®¸

- å¹¶è¡Œæ¨¡æ‹Ÿï¼ˆShadow Registryï¼‰
- äº‹åå¯¹æ¯”ï¼ˆDecision Comparatorï¼‰
- è¯æ®ç§¯ç´¯ï¼ˆReality Alignment Scoreï¼‰
- äººå·¥ç¡®è®¤åè¿ç§»ï¼ˆReview Queue + Migration Toolï¼‰

---

## ğŸ“ˆ å…³é”®æŒ‡æ ‡

### ä»£ç äº§å‡º
- **ç”Ÿäº§ä»£ç **: 35 ä¸ªæ–‡ä»¶ï¼Œ~8,500 è¡Œ
- **æµ‹è¯•ä»£ç **: 40 ä¸ªæ–‡ä»¶ï¼Œ~10,200 è¡Œ
- **æ–‡æ¡£**: 25 ä¸ªæ–‡ä»¶ï¼Œ~5,000 è¡Œ

### æµ‹è¯•è¦†ç›–
- **æ€»æµ‹è¯•æ•°**: 365+
- **é€šè¿‡ç‡**: 100%
- **æµ‹è¯•ç±»å‹**: å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€E2E æµ‹è¯•

### æ•°æ®åº“
- **æ–°å¢è¡¨**: 8 ä¸ª
- **æ–°å¢ç´¢å¼•**: 40+
- **Schema ç‰ˆæœ¬**: v38 â†’ v42

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

### ä¸Šå±‚æ¶æ„
- [Evolvable System Architecture](../EVOLVABLE_SYSTEM_ARCHITECTURE.md)
- [Evolvable System Developer Guide](../EVOLVABLE_SYSTEM_DEVELOPER_GUIDE.md)

### ç›¸å…³ç³»ç»Ÿ
- [Info Need Classifier Integration](../INFO_NEED_CLASSIFIER_INTEGRATION_SUMMARY.md)
- [Info Need Audit Implementation](../INFO_NEED_AUDIT_IMPLEMENTATION.md)
- [Info Need Metrics Dashboard](../INFO_NEED_METRICS_DASHBOARD.md)

### æµ‹è¯•å’ŒéªŒæ”¶
- [Acceptance Tests README](../../tests/acceptance/README_ACCEPTANCE_TESTS.md)
- [Evolvable System Acceptance Tests](../../tests/acceptance/test_evolvable_system_acceptance.py)

---

## ğŸ“ æ”¯æŒ

### é—®é¢˜æ’æŸ¥

1. **Shadow æ²¡æœ‰è¿è¡Œï¼Ÿ**
   - æ£€æŸ¥é…ç½®æ–‡ä»¶ï¼š`agentos/config/shadow_classifiers.yaml`
   - ç¡®è®¤ `enabled: true`
   - æŸ¥çœ‹æ—¥å¿—ï¼š`agentos/logs/shadow_registry.log`

2. **Decision Comparison View æ²¡æœ‰æ•°æ®ï¼Ÿ**
   - ç¡®è®¤ Shadow å·²è¿è¡Œä¸€æ®µæ—¶é—´ï¼ˆè‡³å°‘ 24 å°æ—¶ï¼‰
   - æ£€æŸ¥æ•°æ®åº“ï¼š`SELECT COUNT(*) FROM decision_candidates`
   - è¿è¡Œ Shadow Score è®¡ç®—

3. **ææ¡ˆç”Ÿæˆå¤±è´¥ï¼Ÿ**
   - æ£€æŸ¥æ ·æœ¬æ•°æ˜¯å¦è¶³å¤Ÿï¼ˆ>= 50ï¼‰
   - ç¡®è®¤ Shadow å’Œ Active æœ‰æ˜¾è‘—å·®å¼‚
   - æŸ¥çœ‹æ—¥å¿—ï¼š`agentos/logs/proposal_generation.log`

### å¸¸è§é—®é¢˜

**Q: Shadow å†³ç­–ä¼šå½±å“ç”¨æˆ·å—ï¼Ÿ**
A: ä¸ä¼šã€‚Shadow å†³ç­–ä»…ç”¨äºäº‹ååˆ†æï¼Œæ°¸ä¸è§¦å‘å¤–éƒ¨æ“ä½œã€‚

**Q: å¤šä¹…å¯ä»¥çœ‹åˆ°æ”¹è¿›ææ¡ˆï¼Ÿ**
A: å»ºè®®è‡³å°‘è¿è¡Œ 7 å¤©æ”¶é›†è¶³å¤Ÿæ ·æœ¬ï¼ˆ>= 100ï¼‰åå†ç”Ÿæˆææ¡ˆã€‚

**Q: è¿ç§»å¤±è´¥äº†æ€ä¹ˆåŠï¼Ÿ**
A: ä½¿ç”¨ `agentos classifier migrate rollback` ç«‹å³å›æ»šï¼Œç³»ç»Ÿä¼šåœ¨ 5 åˆ†é’Ÿå†…æ¢å¤ã€‚

**Q: å¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ª Shadow å—ï¼Ÿ**
A: å¯ä»¥ï¼Œä½†å»ºè®®åˆæœŸåªè¿è¡Œ 1-2 ä¸ªï¼Œç¨³å®šåå†å¢åŠ ã€‚

---

## ğŸ“… æ›´æ–°æ—¥å¿—

### v3.0.0 (2026-01-31)
- âœ… å®Œæ•´å®æ–½ Shadow Evaluation + Controlled Adaptation ç³»ç»Ÿ
- âœ… 11 ä¸ªæ ¸å¿ƒä»»åŠ¡å…¨éƒ¨å®Œæˆ
- âœ… 365+ æµ‹è¯•é€šè¿‡
- âœ… ç”Ÿäº§å°±ç»ª

---

## ğŸ‘¥ è´¡çŒ®è€…

æ„Ÿè°¢ä»¥ä¸‹ Agent çš„è´¡çŒ®ï¼š
- ae10553 - DecisionCandidate æ•°æ®æ¨¡å‹
- abb3e6a - Shadow Classifier Registry
- a9dca2a - Audit Log æ‰©å±•
- ae50b6f - Shadow Score è®¡ç®—å¼•æ“
- a3edd82 - å†³ç­–å¯¹æ¯”æŒ‡æ ‡ç”Ÿæˆ
- a9cb804 - Decision Comparison View
- a404b7f - ImprovementProposal æ¨¡å‹
- a4ec252 - BrainOS æ”¹è¿›ææ¡ˆç”Ÿæˆ
- a508908 - Review Queue API
- a88e37f - Classifier ç‰ˆæœ¬åŒ–å·¥å…·
- a7b6a1e - Shadow â†’ Active è¿ç§»å·¥å…·

**åè°ƒè€…**: Claude Sonnet 4.5

---

*æœ€åæ›´æ–°: 2026-01-31*
