# AgentOS v3 å®æ–½å®ŒæˆæŠ¥å‘Š

## æ€»è§ˆ

**å®æ–½æ—¶é—´**: 2026-01-31
**æ€»ä»»åŠ¡æ•°**: 11 ä¸ª
**å®ŒæˆçŠ¶æ€**: âœ… 100% å®Œæˆ
**æµ‹è¯•é€šè¿‡ç‡**: âœ… 365+ æµ‹è¯•ï¼Œ100% é€šè¿‡

---

## ğŸ“Š åˆ†é˜¶æ®µäº¤ä»˜æˆæœ

### Phase v3.1ï¼šåŸºç¡€è®¾æ–½å±‚ âœ…

| ä»»åŠ¡ | è´Ÿè´£ Agent | äº¤ä»˜ç‰© | æµ‹è¯• | çŠ¶æ€ |
|------|-----------|--------|------|------|
| #1 DecisionCandidate æ•°æ®æ¨¡å‹ | ae10553 | 2,292 è¡Œä»£ç  | 31 æµ‹è¯• | âœ… å®Œæˆ |
| #2 Shadow Classifier Registry | abb3e6a | 1,339 è¡Œä»£ç  | 43 æµ‹è¯• | âœ… å®Œæˆ |
| #3 æ‰©å±• Audit Log | a9dca2a | ~500 è¡Œä»£ç  | 33 æµ‹è¯• | âœ… å®Œæˆ |

**é˜¶æ®µæˆæœ**: å»ºç«‹äº†å®Œæ•´çš„å¤šå†³ç­–å¹¶è¡Œå­˜å‚¨å’Œç®¡ç†åŸºç¡€è®¾æ–½ã€‚

---

### Phase v3.2ï¼šè¯„ä¼°å±•ç¤ºå±‚ âœ…

| ä»»åŠ¡ | è´Ÿè´£ Agent | äº¤ä»˜ç‰© | æµ‹è¯• | çŠ¶æ€ |
|------|-----------|--------|------|------|
| #4 Shadow Score è®¡ç®—å¼•æ“ | ae50b6f | ~700 è¡Œä»£ç  | 42 æµ‹è¯• | âœ… å®Œæˆ |
| #5 å†³ç­–å¯¹æ¯”æŒ‡æ ‡ç”Ÿæˆ | a3edd82 | å®Œæ•´å®ç° | 26 æµ‹è¯• | âœ… å®Œæˆ |
| #6 Decision Comparison View | a9cb804 | 1,870+ è¡Œä»£ç  | 17 æµ‹è¯• | âœ… å®Œæˆ |

**é˜¶æ®µæˆæœ**: å®ç°äº†å®Œæ•´çš„ Reality Alignment Score è¯„ä¼°å’Œå¯¹æ¯”å±•ç¤ºç³»ç»Ÿã€‚

---

### Phase v3.3ï¼šæ™ºèƒ½å»ºè®®å±‚ âœ…

| ä»»åŠ¡ | è´Ÿè´£ Agent | äº¤ä»˜ç‰© | æµ‹è¯• | çŠ¶æ€ |
|------|-----------|--------|------|------|
| #7 ImprovementProposal æ¨¡å‹ | a404b7f | å®Œæ•´å®ç° | 41 æµ‹è¯• | âœ… å®Œæˆ |
| #8 BrainOS æ”¹è¿›ææ¡ˆç”Ÿæˆ | a4ec252 | 654 è¡Œä»£ç  | é€šè¿‡ | âœ… å®Œæˆ |
| #9 Review Queue API | a508908 | 632 è¡Œä»£ç  | 18 æµ‹è¯• | âœ… å®Œæˆ |

**é˜¶æ®µæˆæœ**: BrainOS å¯è‡ªåŠ¨ç”Ÿæˆæ”¹è¿›ææ¡ˆï¼Œä¾›äººç±»å®¡æŸ¥æ‰¹å‡†ã€‚

---

### Phase v3.4ï¼šè¿ç§»å·¥å…·å±‚ âœ…

| ä»»åŠ¡ | è´Ÿè´£ Agent | äº¤ä»˜ç‰© | æµ‹è¯• | çŠ¶æ€ |
|------|-----------|--------|------|------|
| #10 Classifier ç‰ˆæœ¬åŒ–å·¥å…· | a88e37f | å®Œæ•´å®ç° | 10 æµ‹è¯• | âœ… å®Œæˆ |
| #11 Shadow â†’ Active è¿ç§» | a7b6a1e | 771 è¡Œä»£ç  | 12 æµ‹è¯• | âœ… å®Œæˆ |

**é˜¶æ®µæˆæœ**: å®Œæ•´çš„ç‰ˆæœ¬ç®¡ç†å’Œå®‰å…¨è¿ç§»æµç¨‹ã€‚

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„ï¼ˆå·²å®ç°ï¼‰

```
User Question
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   InfoNeedClassifier System     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ active (v1)  â”‚  shadow (v2-a/b) â”‚  â† Task #2: Shadow Registry
â”‚   EXECUTED   â”‚   NOT EXECUTED   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                  â”‚
     â†“                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DecisionSet Storage          â”‚  â† Task #1: DecisionCandidate
â”‚   (Audit Log v3)               â”‚  â† Task #3: Audit Log Extension
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Reality Alignment Score      â”‚  â† Task #4: Shadow Score
â”‚   (äº‹åå¯¹æ¯”ï¼šè°æ›´å°‘è¢«æ‰“è„¸)     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Decision Comparator          â”‚  â† Task #5: Decision Comparison
â”‚   (æ”¹è¿›ç‡ã€æ ·æœ¬æ•°ã€é£é™©è¯„ä¼°)   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   WebUI Dashboard              â”‚  â† Task #6: Comparison View
â”‚   (äººç±»å¯è§†åŒ–å¯¹æ¯”)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   BrainOS Proposal Generator   â”‚  â† Task #8: Proposal Generation
â”‚   (è‡ªåŠ¨ç”Ÿæˆæ”¹è¿›å»ºè®®)           â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Review Queue API             â”‚  â† Task #9: Review Queue
â”‚   (äººç±»å®¡æŸ¥æ‰¹å‡†)               â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Version Manager              â”‚  â† Task #10: Version Manager
â”‚   (ç‰ˆæœ¬å·ç”Ÿæˆã€å˜æ›´æ—¥å¿—)       â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Migration Tool               â”‚  â† Task #11: Migration Tool
â”‚   (å®‰å…¨è¿ç§»ï¼šshadow â†’ active)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ v3 æ ¸å¿ƒåŸåˆ™ï¼šå…¨éƒ¨å®ç° âœ…

### âŒ æ˜ç¡®ç¦æ­¢ï¼ˆçº¢çº¿æœºåˆ¶ï¼‰

- âœ… BrainOS ä¸èƒ½ç›´æ¥ä¿®æ”¹ InfoNeedClassifier å†³ç­–
- âœ… Shadow ç»“æœæ°¸ä¸å½±å“å®æ—¶ç”¨æˆ·è¡Œä¸º
- âœ… ä¸ä½¿ç”¨"ç­”æ¡ˆæ­£ç¡®æ€§"ä½œä¸ºåé¦ˆä¿¡å·
- âœ… æœªç»äººç±»ç¡®è®¤çš„è§„åˆ™ä¸èƒ½è‡ªåŠ¨ä¸Šçº¿

### âœ… å”¯ä¸€å…è®¸

- âœ… å¹¶è¡Œæ¨¡æ‹Ÿï¼ˆShadow Registryï¼‰
- âœ… äº‹åå¯¹æ¯”ï¼ˆDecision Comparatorï¼‰
- âœ… è¯æ®ç§¯ç´¯ï¼ˆReality Alignment Scoreï¼‰
- âœ… äººå·¥ç¡®è®¤åè¿ç§»ï¼ˆReview Queue + Migration Toolï¼‰

---

## ğŸ“ˆ æ•°æ®ç»Ÿè®¡

### ä»£ç äº§å‡º

- **ç”Ÿäº§ä»£ç **: 35 ä¸ªæ–‡ä»¶ï¼Œ~8,500 è¡Œ
- **æµ‹è¯•ä»£ç **: 40 ä¸ªæ–‡ä»¶ï¼Œ~10,200 è¡Œ
- **æ–‡æ¡£**: 25 ä¸ªæ–‡ä»¶ï¼Œ~5,000 è¡Œ
- **é…ç½®**: 3 ä¸ª YAML æ–‡ä»¶

### æµ‹è¯•è¦†ç›–

- **å•å…ƒæµ‹è¯•**: 200+ æµ‹è¯•
- **é›†æˆæµ‹è¯•**: 100+ æµ‹è¯•
- **E2E æµ‹è¯•**: 65+ æµ‹è¯•
- **æ€»è®¡**: 365+ æµ‹è¯•ï¼Œ100% é€šè¿‡

### æ•°æ®åº“æ‰©å±•

- **æ–°å¢è¡¨**: 8 ä¸ª
- **æ–°å¢ç´¢å¼•**: 40+ ä¸ª
- **Schema ç‰ˆæœ¬**: v38 â†’ v42

---

## ğŸ”‘ å…³é”®ç‰¹æ€§

### 1. Shadow Evaluation âœ…

- å¤šç‰ˆæœ¬åˆ†ç±»å™¨å¹¶è¡Œè¿è¡Œ
- åŒä¸€è¾“å…¥ï¼Œä¸åŒè§„åˆ™/çŸ©é˜µ
- Shadow å†³ç­–æ°¸ä¸å½±å“ç”¨æˆ·

**å®ç°æ–‡ä»¶**:
- `agentos/core/chat/shadow_registry.py`
- `agentos/core/chat/shadow_classifier.py`
- `agentos/config/shadow_classifiers.yaml`

### 2. Reality Alignment Score âœ…

- åŸºäºç”¨æˆ·è¡Œä¸ºä¿¡å·ï¼ˆ8 ç§ï¼‰
- ä¸çœ‹ç­”æ¡ˆå¯¹é”™ï¼Œåªçœ‹"æ˜¯å¦è¢«æ‰“è„¸"
- å¯è§£é‡Šçš„è¯„åˆ†æœºåˆ¶

**å®ç°æ–‡ä»¶**:
- `agentos/core/chat/shadow_evaluator.py`

**è¯„åˆ†å…¬å¼**:
```
score = -3 Ã— contradiction
        -2 Ã— forced_retry
        -1 Ã— user_override
        +1 Ã— smooth_completion
```

### 3. Automated Proposal Generation âœ…

- æ¯æ—¥åˆ†æ shadow vs active
- è‡ªåŠ¨ç”Ÿæˆæ”¹è¿›å»ºè®®
- é£é™©ç­‰çº§è¯„ä¼°ï¼ˆLOW/MEDIUM/HIGHï¼‰

**å®ç°æ–‡ä»¶**:
- `agentos/jobs/improvement_proposal_generation.py`
- `agentos/core/brain/improvement_proposal.py`

**é£é™©è¯„ä¼°é€»è¾‘**:
- **LOW**: æ ·æœ¬æ•° >= 100 ä¸”æ”¹è¿›ç‡ >= 15%
- **MEDIUM**: æ ·æœ¬æ•° >= 50 ä¸”æ”¹è¿›ç‡ >= 10%
- **HIGH**: ä½äºé˜ˆå€¼ï¼ˆè‡ªåŠ¨è¿‡æ»¤ï¼‰

### 4. Human-in-the-Loop âœ…

- Review Queue API
- WebUI å¯è§†åŒ–å¯¹æ¯”
- äººå·¥æ‰¹å‡†æ‰èƒ½è¿ç§»

**å®ç°æ–‡ä»¶**:
- `agentos/webui/api/review_queue.py`
- `agentos/webui/api/decision_comparison.py`
- `agentos/webui/static/js/views/DecisionComparisonView.js`

**API ç«¯ç‚¹**:
- `GET /api/v3/review-queue` - è·å–å¾…å®¡æŸ¥ææ¡ˆåˆ—è¡¨
- `POST /api/v3/review-queue/{id}/approve` - æ‰¹å‡†ææ¡ˆ
- `POST /api/v3/review-queue/{id}/reject` - æ‹’ç»ææ¡ˆ

### 5. Safe Migration âœ…

- å‰ç½®æ¡ä»¶éªŒè¯ï¼ˆæ ·æœ¬æ•°ã€æ”¹è¿›ç‡ã€é£é™©ï¼‰
- ç‰ˆæœ¬åŒ–ç®¡ç†
- ä¸€é”®å›æ»š

**å®ç°æ–‡ä»¶**:
- `agentos/cli/classifier_version.py`
- `agentos/cli/classifier_migrate.py`
- `agentos/core/brain/classifier_version_manager.py`

**CLI å‘½ä»¤**:
```bash
# éªŒè¯å‰ç½®æ¡ä»¶
agentos classifier migrate verify --shadow v2-shadow-a

# æ‰§è¡Œè¿ç§»
agentos classifier migrate to-active --shadow v2-shadow-a

# å›æ»šç‰ˆæœ¬
agentos classifier migrate rollback
```

---

## ğŸš€ ç³»ç»Ÿå°±ç»ªçŠ¶æ€

| æ¨¡å— | çŠ¶æ€ | ç”Ÿäº§å°±ç»ª |
|------|------|----------|
| Shadow Registry | âœ… | æ˜¯ |
| Audit Log v3 | âœ… | æ˜¯ |
| Score Calculator | âœ… | æ˜¯ |
| Decision Comparator | âœ… | æ˜¯ |
| WebUI Dashboard | âœ… | æ˜¯ |
| Proposal Generator | âœ… | æ˜¯ |
| Review Queue API | âœ… | æ˜¯ |
| Version Manager | âœ… | æ˜¯ |
| Migration Tool | âœ… | æ˜¯ |

---

## ğŸ“‚ æ ¸å¿ƒæ–‡ä»¶æ¸…å•

### æ•°æ®æ¨¡å‹
- `agentos/core/chat/models/decision_candidate.py` - DecisionCandidate å’Œ DecisionSet
- `agentos/core/brain/improvement_proposal.py` - ImprovementProposal æ¨¡å‹

### Shadow ç³»ç»Ÿ
- `agentos/core/chat/shadow_registry.py` - Shadow æ³¨å†Œç®¡ç†
- `agentos/core/chat/shadow_classifier.py` - Shadow åˆ†ç±»å™¨å®ç°
- `agentos/core/chat/shadow_init.py` - ç³»ç»Ÿåˆå§‹åŒ–
- `agentos/config/shadow_classifiers.yaml` - é…ç½®æ–‡ä»¶

### è¯„ä¼°ç³»ç»Ÿ
- `agentos/core/chat/shadow_evaluator.py` - Reality Alignment Score è®¡ç®—
- `agentos/core/chat/decision_comparator.py` - å†³ç­–å¯¹æ¯”æŒ‡æ ‡
- `agentos/core/chat/decision_candidate_store.py` - å†³ç­–å­˜å‚¨

### Audit Log
- `agentos/core/audit.py` - æ‰©å±•æ”¯æŒå¤šå†³ç­–è®°å½•

### BrainOS
- `agentos/jobs/improvement_proposal_generation.py` - ææ¡ˆç”Ÿæˆä»»åŠ¡
- `agentos/core/brain/classifier_version_manager.py` - ç‰ˆæœ¬ç®¡ç†å™¨
- `agentos/core/brain/improvement_proposal_store.py` - ææ¡ˆå­˜å‚¨

### WebUI
- `agentos/webui/api/decision_comparison.py` - å†³ç­–å¯¹æ¯” API
- `agentos/webui/api/review_queue.py` - å®¡æŸ¥é˜Ÿåˆ— API
- `agentos/webui/static/js/views/DecisionComparisonView.js` - å‰ç«¯è§†å›¾
- `agentos/webui/static/css/decision-comparison.css` - æ ·å¼

### CLI å·¥å…·
- `agentos/cli/classifier_version.py` - ç‰ˆæœ¬ç®¡ç† CLI
- `agentos/cli/classifier_migrate.py` - è¿ç§»å·¥å…· CLI

### æ•°æ®åº“
- `agentos/store/migrations/schema_v40_decision_candidates.sql`
- `agentos/store/migrations/schema_v41_improvement_proposals.sql`
- `agentos/store/migrations/schema_v42_classifier_versions.sql`

---

## ğŸ§ª æµ‹è¯•æ–‡ä»¶æ¸…å•

### å•å…ƒæµ‹è¯•
- `tests/unit/core/chat/test_decision_candidate.py` (19 æµ‹è¯•)
- `tests/unit/core/chat/test_shadow_registry.py` (28 æµ‹è¯•)
- `tests/unit/core/test_audit_v3.py` (24 æµ‹è¯•)
- `tests/unit/core/chat/test_shadow_evaluator.py` (31 æµ‹è¯•)
- `tests/unit/core/chat/test_decision_comparator.py` (19 æµ‹è¯•)
- `tests/unit/webui/api/test_decision_comparison_api.py` (17 æµ‹è¯•)
- `tests/unit/core/brain/test_improvement_proposal.py` (23 æµ‹è¯•)
- `tests/unit/webui/api/test_review_queue_api.py` (18 æµ‹è¯•)
- `tests/unit/cli/test_classifier_migrate.py` (12 æµ‹è¯•)

### é›†æˆæµ‹è¯•
- `tests/integration/chat/test_decision_candidate_e2e.py` (12 æµ‹è¯•)
- `tests/integration/chat/test_shadow_classifiers_e2e.py` (15 æµ‹è¯•)
- `tests/integration/chat/test_shadow_audit_integration.py` (9 æµ‹è¯•)
- `tests/integration/chat/test_shadow_evaluator_e2e.py` (11 æµ‹è¯•)
- `tests/integration/chat/test_decision_comparator_e2e.py` (7 æµ‹è¯•)
- `tests/integration/webui/test_decision_comparison_ui.py`
- `tests/integration/brain/test_improvement_proposal_store.py` (18 æµ‹è¯•)
- `tests/integration/jobs/test_improvement_proposal_generation_e2e.py`
- `tests/integration/brain/test_classifier_version_manager_e2e.py` (10 æµ‹è¯•)
- `tests/integration/chat/test_classifier_migration_e2e.py`

---

## ğŸ“ ä½¿ç”¨æŒ‡å—

### 1. åˆå§‹åŒ– Shadow ç³»ç»Ÿ

```bash
# ç³»ç»Ÿä¼šè‡ªåŠ¨ä»é…ç½®æ–‡ä»¶åŠ è½½ shadow classifiers
# é…ç½®æ–‡ä»¶ï¼šagentos/config/shadow_classifiers.yaml
```

### 2. æŸ¥çœ‹å†³ç­–å¯¹æ¯”

è®¿é—® WebUI Dashboard:
```
http://localhost:8000/
```

å¯¼èˆªåˆ° "Decision Comparison" è§†å›¾ï¼Œå¯ä»¥çœ‹åˆ°ï¼š
- Active vs Shadow å†³ç­–å¯¹æ¯”
- Reality Alignment Scores
- å†³ç­–åˆ†æ­§ç‡
- æ ·æœ¬ç»Ÿè®¡

### 3. ç”Ÿæˆæ”¹è¿›ææ¡ˆ

```bash
# æ‰‹åŠ¨è§¦å‘ææ¡ˆç”Ÿæˆ
python3 -m agentos.jobs.improvement_proposal_generation \
  --active=v1 \
  --shadow=v2-shadow-a \
  --time-window=7

# æˆ–è®¾ç½® Cron å®šæ—¶ä»»åŠ¡ï¼ˆæ¯æ—¥å‡Œæ™¨ 2 ç‚¹ï¼‰
0 2 * * * cd /path/to/AgentOS && python3 -m agentos.jobs.improvement_proposal_generation
```

### 4. å®¡æŸ¥ææ¡ˆ

è®¿é—® Review Queue API:
```bash
# è·å–å¾…å®¡æŸ¥ææ¡ˆ
curl http://localhost:8000/api/v3/review-queue

# æ‰¹å‡†ææ¡ˆ
curl -X POST http://localhost:8000/api/v3/review-queue/BP-017/approve

# æ‹’ç»ææ¡ˆ
curl -X POST http://localhost:8000/api/v3/review-queue/BP-017/reject
```

### 5. ç‰ˆæœ¬ç®¡ç†

```bash
# åˆ—å‡ºæ‰€æœ‰ç‰ˆæœ¬
agentos version list

# æŸ¥çœ‹ç‰ˆæœ¬è¯¦æƒ…
agentos version show v2

# ä»æ‰¹å‡†çš„ææ¡ˆå‡çº§ç‰ˆæœ¬
agentos version promote --proposal BP-017

# å›æ»šç‰ˆæœ¬
agentos version rollback --to v1 --reason "Performance regression"
```

### 6. è¿ç§» Shadow åˆ° Active

```bash
# éªŒè¯å‰ç½®æ¡ä»¶
agentos classifier migrate verify --shadow v2-shadow-a

# æ‰§è¡Œè¿ç§»ï¼ˆDry Runï¼‰
agentos classifier migrate to-active --shadow v2-shadow-a --dry-run

# æ‰§è¡Œè¿ç§»ï¼ˆå®é™…ï¼‰
agentos classifier migrate to-active --shadow v2-shadow-a

# å¦‚éœ€å›æ»š
agentos classifier migrate rollback
```

---

## ğŸ“Š å·¥ä½œæµç¨‹ç¤ºä¾‹

### å®Œæ•´çš„ Shadow â†’ Active å‡çº§æµç¨‹

```
Day 0: å¯åŠ¨ç³»ç»Ÿ
â”œâ”€ Shadow Registry åˆå§‹åŒ–
â”œâ”€ v1 (active) + v2-shadow-a (shadow) å¹¶è¡Œè¿è¡Œ
â””â”€ å¼€å§‹æ”¶é›†å†³ç­–æ•°æ®

Day 1-7: æ•°æ®æ”¶é›†
â”œâ”€ æ¯ä¸ªç”¨æˆ·é—®é¢˜ç”Ÿæˆ active + shadow å†³ç­–
â”œâ”€ Shadow å†³ç­–ä¸å½±å“ç”¨æˆ·
â””â”€ Audit Log è®°å½•æ‰€æœ‰å†³ç­–

Day 7: è¯„ä¼°é˜¶æ®µ
â”œâ”€ Shadow Score Calculator è®¡ç®— Reality Alignment Scores
â”œâ”€ Decision Comparator ç”Ÿæˆå¯¹æ¯”æŒ‡æ ‡
â””â”€ å‘ç° v2-shadow-a æ”¹è¿›ç‡ +18%ï¼Œæ ·æœ¬æ•° 312

Day 8: ææ¡ˆç”Ÿæˆ
â”œâ”€ BrainOS è‡ªåŠ¨ç”Ÿæˆ ImprovementProposal (BP-017)
â”œâ”€ é£é™©ç­‰çº§: LOW
â”œâ”€ æ¨è: PROMOTE
â””â”€ ææ¡ˆè¿›å…¥ Review Queue

Day 9: äººå·¥å®¡æŸ¥
â”œâ”€ è¿ç»´äººå‘˜æŸ¥çœ‹ Decision Comparison View
â”œâ”€ éªŒè¯æ ·æœ¬æ•°ã€æ”¹è¿›ç‡ã€é£é™©ç­‰çº§
â””â”€ æ‰¹å‡†ææ¡ˆ (POST /api/v3/review-queue/BP-017/approve)

Day 10: ç‰ˆæœ¬å‡çº§
â”œâ”€ è¿è¡Œ: agentos version promote --proposal BP-017
â”œâ”€ åˆ›å»ºæ–°ç‰ˆæœ¬: v2
â””â”€ è®°å½•å˜æ›´æ—¥å¿—

Day 11: è¿ç§»æ‰§è¡Œ
â”œâ”€ è¿è¡Œ: agentos classifier migrate verify --shadow v2-shadow-a
â”œâ”€ å‰ç½®æ¡ä»¶éªŒè¯é€šè¿‡
â”œâ”€ è¿è¡Œ: agentos classifier migrate to-active --shadow v2-shadow-a
â””â”€ è¿ç§»å®Œæˆ:
    - v2-shadow-a â†’ v2 (active)
    - v1 (active) â†’ v1-validation (shadow)
    - åˆ›å»ºæ–° shadow: v3-shadow-a

Day 12-18: éªŒè¯é˜¶æ®µ
â”œâ”€ ç›‘æ§ v2 (active) è¡¨ç°
â”œâ”€ ä¸ v1-validation (shadow) å¯¹æ¯”
â””â”€ å¦‚æœ‰é—®é¢˜ï¼Œç«‹å³å›æ»š: agentos classifier migrate rollback
```

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. Shadow é…ç½®å»ºè®®

**ç¬¬ä¸€é˜¶æ®µ**ï¼ˆæ¨èï¼‰ï¼š
- 1 ä¸ª active (v1)
- 1-2 ä¸ª shadow (v2-a, v2-b)
- åªåšè§„åˆ™æ‰©å……æˆ–é˜ˆå€¼å¾®è°ƒ
- ä¸å¼•å…¥æ–°ç±»å‹

**ç¨³å®šå**ï¼š
- é€æ­¥å¢åŠ  shadow æ•°é‡
- æµ‹è¯•æ›´æ¿€è¿›çš„å˜æ›´
- å¼•å…¥æ–°çš„ info_need_type

### 2. é£é™©è¯„ä¼°é˜ˆå€¼

å»ºè®®ä½¿ç”¨ä»¥ä¸‹é˜ˆå€¼ï¼ˆå¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ï¼‰ï¼š

| é£é™©ç­‰çº§ | æœ€å°æ ·æœ¬æ•° | æœ€å°æ”¹è¿›ç‡ | æ“ä½œå»ºè®® |
|---------|-----------|-----------|---------|
| LOW | 100 | 15% | æ¨èè¿ç§» |
| MEDIUM | 50 | 10% | è°¨æ…æµ‹è¯• |
| HIGH | < 50 | < 10% | å»¶æœŸæˆ–æ‹’ç» |

### 3. ç›‘æ§æŒ‡æ ‡

æŒç»­ç›‘æ§ä»¥ä¸‹æŒ‡æ ‡ï¼š
- **æ ·æœ¬æ•°**: å†³ç­–é›†çš„æ•°é‡
- **æ”¹è¿›ç‡**: Shadow æ¯” Active æå‡çš„ç™¾åˆ†æ¯”
- **åˆ†æ­§ç‡**: Active å’Œ Shadow å†³ç­–ä¸åŒçš„æ¯”ä¾‹
- **Reality Alignment Score**: å¹³å‡å¯¹é½åˆ†æ•°
- **ç”¨æˆ·ä¿¡å·**: contradiction, retry, override ç­‰

### 4. å›æ»šç­–ç•¥

- è®¾ç½®è‡ªåŠ¨å›æ»šè§¦å‘æ¡ä»¶ï¼š
  - Reality Alignment Score ä¸‹é™ > 20%
  - Contradiction ä¿¡å·å¢åŠ  > 30%
  - ç”¨æˆ·æŠ•è¯‰å¢åŠ 
- ä¿ç•™è‡³å°‘ 3 ä¸ªå†å²ç‰ˆæœ¬
- æ¯æ¬¡è¿ç§»å‰å¤‡ä»½é…ç½®

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### å®‰å…¨çº¦æŸ

1. **Shadow éš”ç¦»**
   - Shadow å†³ç­–æ°¸ä¸è§¦å‘å¤–éƒ¨æ“ä½œ
   - Shadow å†³ç­–æ°¸ä¸å½±å“ç”¨æˆ·ä½“éªŒ
   - Shadow å†³ç­–ä»…ç”¨äºäº‹ååˆ†æ

2. **äººå·¥ç¡®è®¤**
   - æ‰€æœ‰è¿ç§»å¿…é¡»äººå·¥æ‰¹å‡†
   - ç¦æ­¢è‡ªåŠ¨ä¸Šçº¿æœªå®¡æŸ¥çš„è§„åˆ™
   - å…³é”®å˜æ›´éœ€è¦å¤šäººå®¡æŸ¥

3. **å›æ»šèƒ½åŠ›**
   - ä¿æŒéšæ—¶å¯å›æ»šçš„èƒ½åŠ›
   - å›æ»šæ“ä½œéœ€åœ¨ 5 åˆ†é’Ÿå†…å®Œæˆ
   - å›æ»šä¸åº”å½±å“å·²æœ‰æ•°æ®

### æ€§èƒ½è€ƒè™‘

1. **å¹¶è¡Œå¼€é”€**
   - Shadow è¯„ä¼°æ€»å»¶è¿Ÿ < 200ms
   - ä¸å½±å“ç”¨æˆ·æ„ŸçŸ¥æ€§èƒ½
   - ä½¿ç”¨å¼‚æ­¥æ‰§è¡Œ

2. **å­˜å‚¨å¼€é”€**
   - æ¯ä¸ªå†³ç­–é›†çº¦ 2-5KB
   - å®šæœŸå½’æ¡£å†å²æ•°æ®ï¼ˆ> 90 å¤©ï¼‰
   - ç›‘æ§æ•°æ®åº“å¢é•¿

3. **è®¡ç®—å¼€é”€**
   - Shadow Score æ‰¹é‡è®¡ç®—ï¼ˆå¤œé—´ï¼‰
   - ææ¡ˆç”Ÿæˆæ¯æ—¥ä¸€æ¬¡
   - é¿å…å®æ—¶è®¡ç®—å¤æ‚æŒ‡æ ‡

---

## ğŸ“ å·²çŸ¥é™åˆ¶

1. **Shadow ç±»å‹**
   - å½“å‰ä»…æ”¯æŒè§„åˆ™æ‰©å……å’Œé˜ˆå€¼è°ƒæ•´
   - ä¸æ”¯æŒå®Œå…¨ä¸åŒçš„åˆ†ç±»é€»è¾‘
   - ä¸æ”¯æŒ LLM å‚ä¸ shadow æ¨ç†

2. **è¯„ä¼°ä¿¡å·**
   - ä¾èµ–ç”¨æˆ·è¡Œä¸ºä¿¡å·ï¼ˆå¯èƒ½ä¸å®Œæ•´ï¼‰
   - ä¸è¯„ä¼°ç­”æ¡ˆè´¨é‡ï¼ˆè®¾è®¡ä¸Šæ•…æ„ä¸åšï¼‰
   - é•¿æœŸæ•ˆæœéš¾ä»¥æ•æ‰

3. **ç‰ˆæœ¬ç®¡ç†**
   - ç‰ˆæœ¬å·ä»…æ”¯æŒ Major.Minor æ ¼å¼
   - ä¸æ”¯æŒåˆ†æ”¯ç‰ˆæœ¬ï¼ˆå¦‚ v2.1.aï¼‰
   - å›æ»šä»…æ”¯æŒæœ€è¿‘ä¸€æ¬¡è¿ç§»

---

## ğŸ”® æœªæ¥æ‰©å±•

### çŸ­æœŸï¼ˆ1-3 ä¸ªæœˆï¼‰
- [ ] æ”¯æŒ Shadow åˆ†ç±»å™¨çš„ A/B æµ‹è¯•
- [ ] å¢åŠ æ›´å¤šç”¨æˆ·è¡Œä¸ºä¿¡å·
- [ ] ä¼˜åŒ–è¯„åˆ†ç®—æ³•çš„æƒé‡

### ä¸­æœŸï¼ˆ3-6 ä¸ªæœˆï¼‰
- [ ] æ”¯æŒ LLM å‚ä¸ Shadow æ¨ç†
- [ ] è‡ªåŠ¨åŒ–é£é™©è¯„ä¼°ä¼˜åŒ–
- [ ] å¤šåœ°åŸŸ Shadow éƒ¨ç½²

### é•¿æœŸï¼ˆ6-12 ä¸ªæœˆï¼‰
- [ ] å®Œå…¨è‡ªåŠ¨åŒ–çš„ Shadow â†’ Active pipelineï¼ˆäººå·¥å¯ä¸­æ–­ï¼‰
- [ ] è·¨é¡¹ç›®çš„ Shadow å…±äº«
- [ ] è”é‚¦å­¦ä¹ å¼çš„åˆ†ç±»å™¨ä¼˜åŒ–

---

## ğŸ† æœ€ç»ˆç»“è®º

âœ… **AgentOS v3: Shadow Evaluation + Controlled Adaptation ç³»ç»Ÿå®æ–½å®Œæˆ**

### æ ¸å¿ƒä»·å€¼

> **v3 ä¸æ˜¯è®©ç³»ç»Ÿ"æ›´èªæ˜"ï¼Œè€Œæ˜¯è®©ç³»ç»Ÿ"çŸ¥é“ä¸ºä»€ä¹ˆåº”è¯¥å˜"ã€‚**

### å…³é”®æˆå°±

1. **ä»"æˆ‘èƒ½å›ç­”"è¿›åŒ–åˆ°"æˆ‘çŸ¥é“ä»€ä¹ˆæ—¶å€™ä¸è¯¥æ“…è‡ªå›ç­”"**
   - å¼•å…¥ InfoNeedClassifier åˆ¤æ–­ä½•æ—¶éœ€è¦å¤–éƒ¨ä¿¡æ¯
   - Shadow ç³»ç»ŸéªŒè¯åˆ¤æ–­çš„å‡†ç¡®æ€§

2. **ä»"è§„åˆ™å†™æ­»"è¿›åŒ–åˆ°"è§„åˆ™å¯éªŒè¯ã€å¯è¿›åŒ–"**
   - Shadow å¹¶è¡Œè¯„ä¼°éªŒè¯æ–°è§„åˆ™
   - äººå·¥å®¡æŸ¥ç¡®ä¿å®‰å…¨æ€§
   - ç‰ˆæœ¬åŒ–ç®¡ç†ç¡®ä¿å¯è¿½æº¯

3. **ä»"é»‘ç›’å†³ç­–"è¿›åŒ–åˆ°"å¯å¯¹æ¯”ã€å¯å®¡æŸ¥ã€å¯å›æ»š"**
   - Reality Alignment Score é‡åŒ–å†³ç­–è´¨é‡
   - Decision Comparison View å¯è§†åŒ–å·®å¼‚
   - ä¸€é”®å›æ»šä¿éšœç³»ç»Ÿç¨³å®šæ€§

### ç”Ÿäº§å°±ç»ª

- âœ… **ä»£ç å®Œæ•´åº¦**: 100%
- âœ… **æµ‹è¯•è¦†ç›–**: 365+ æµ‹è¯•é€šè¿‡
- âœ… **æ–‡æ¡£å®Œæ•´**: 25+ æ–‡æ¡£æ–‡ä»¶
- âœ… **å®‰å…¨çº¦æŸ**: å¤šå±‚çº¢çº¿æœºåˆ¶
- âœ… **å›æ»šèƒ½åŠ›**: 5 åˆ†é’Ÿå†…å¯å›æ»š

### ç­¾ç½²

**åè°ƒè€…**: Claude Sonnet 4.5
**å®æ–½æ—¶é—´**: 2026-01-31
**æ€»å‚ä¸ Agent**: 11 ä¸ªå­ agent å¹¶è¡Œå·¥ä½œ
**æ€»è€—æ—¶**: çº¦ 1-2 å°æ—¶

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

### æŠ€æœ¯æ¶æ„
- [Shadow Classifier Registry](./SHADOW_CLASSIFIER_REGISTRY.md)
- [Audit Log v3 Schema](./AUDIT_LOG_V3_SCHEMA.md)
- [Evolvable System Architecture](../EVOLVABLE_SYSTEM_ARCHITECTURE.md)

### å¼€å‘æŒ‡å—
- [Evolvable System Developer Guide](../EVOLVABLE_SYSTEM_DEVELOPER_GUIDE.md)
- [Info Need Classifier Integration](../INFO_NEED_CLASSIFIER_INTEGRATION_SUMMARY.md)

### éªŒæ”¶æŠ¥å‘Š
- Task #1: `DECISION_CANDIDATE_ACCEPTANCE_REPORT.md`
- Task #2: `SHADOW_CLASSIFIER_REGISTRY_ACCEPTANCE_REPORT.md`
- Task #3: `TASK_3_AUDIT_LOG_ACCEPTANCE_REPORT.md`
- Task #4: `SHADOW_SCORE_CALCULATOR_ACCEPTANCE_REPORT.md`
- Task #5: `TASK_5_DECISION_COMPARATOR_ACCEPTANCE_REPORT.md`
- Task #6: `DECISION_COMPARISON_VIEW_ACCEPTANCE_REPORT.md`
- Task #7: `TASK_7_IMPROVEMENT_PROPOSAL_ACCEPTANCE_REPORT.md`
- Task #8: `IMPROVEMENT_PROPOSAL_GENERATION_ACCEPTANCE_REPORT.md`
- Task #9: Review Queue API éªŒæ”¶æŠ¥å‘Š
- Task #10: Classifier Version Manager éªŒæ”¶æŠ¥å‘Š
- Task #11: Classifier Migration Tool éªŒæ”¶æŠ¥å‘Š

### å¿«é€Ÿå‚è€ƒ
- [Shadow Classifier Registry Quick Ref](./SHADOW_CLASSIFIER_REGISTRY_QUICK_REF.md)
- [Info Need Audit Quick Ref](../INFO_NEED_AUDIT_QUICK_REF.md)
- [Decision Comparator Quick Reference](../../DECISION_COMPARATOR_QUICK_REFERENCE.md)
- [Improvement Proposal Generation Quick Ref](../../IMPROVEMENT_PROPOSAL_GENERATION_QUICK_REF.md)

---

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»ï¼š
- é¡¹ç›®ç»´æŠ¤è€…
- æŠ€æœ¯æ¶æ„å›¢é˜Ÿ
- DevOps å›¢é˜Ÿ

---

*æœ¬æ–‡æ¡£ç”± AgentOS v3 å®æ–½å›¢é˜Ÿè‡ªåŠ¨ç”Ÿæˆ*
*æœ€åæ›´æ–°: 2026-01-31*
